<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Vokabeltrainer ‚Äì Beeferino</title>
<style>
  :root {
    --blue: #2563eb;
    --blue-dark: #1e3a8a;
    --bg: #f5f8ff;
    --card-bg: rgba(255,255,255,0.8);
    --success: #22c55e;
    --error: #ef4444;
    --neutral: #9ca3af;
  }
  * { box-sizing: border-box; }
  body {
    font-family: "Inter", system-ui, sans-serif;
    background: linear-gradient(145deg,#eff3ff,#dbeafe);
    margin:0; color:#111827;
  }
  .app {
    max-width:900px; margin:30px auto; padding:20px;
    background:var(--card-bg);
    border-radius:20px;
    box-shadow:0 8px 30px rgba(0,0,0,0.1);
    backdrop-filter:blur(8px);
  }
  h1 {
    text-align:center; margin:0; font-size:2rem; font-weight:700;
    color:var(--blue-dark);
  }
  .divider {
    width:160px; height:4px; background:var(--blue);
    border-radius:4px; margin:10px auto 20px;
  }

  /* === Men√ºleiste === */
  .controls, .functions, .footer-buttons {
    display:flex; flex-wrap:wrap; justify-content:center; gap:12px;
    margin-bottom:15px;
  }
  select, button {
    font-family:inherit;
    font-size:1rem;
    border-radius:10px;
    border:1px solid #d1d5db;
    padding:8px 12px;
  }
  .kachel {
    flex:1 1 250px;
    background:var(--blue);
    color:white;
    padding:14px 20px;
    border-radius:14px;
    text-align:center;
    font-weight:600;
    cursor:pointer;
    box-shadow:0 4px 12px rgba(0,0,0,0.1);
    transition:all .2s;
  }
  .kachel:hover { transform:translateY(-2px); background:#1d4ed8; }

  /* === Spielbereich === */
  #stage {
    display:none;
    background:rgba(255,255,255,0.9);
    border-radius:20px;
    padding:25px;
    text-align:center;
    box-shadow:inset 0 0 10px rgba(0,0,0,0.05);
  }
  .category {
    display:inline-block;
    background:#fff4cc;
    color:#92400e;
    font-weight:700;
    padding:8px 16px;
    border-radius:999px;
    margin-bottom:16px;
    box-shadow:0 2px 4px rgba(0,0,0,0.05);
  }
  .word { font-size:1.8rem; font-weight:700; margin:10px 0; }
  .hint { color:#6b7280; margin-bottom:10px; font-style:italic; }
  .btn-group { display:flex; justify-content:center; gap:12px; margin-top:10px; flex-wrap:wrap; }
  .btn {
    border:none; border-radius:10px; padding:10px 20px; font-weight:600;
    cursor:pointer; font-size:1rem;
  }
  .btn-ok { background:var(--success); color:white; }
  .btn-wrong { background:var(--error); color:white; }
  .btn-skip { background:var(--neutral); color:white; }

  /* === Eingabefeld === */
  .input-row {
    margin-top:15px;
    display:flex; justify-content:center; align-items:center; gap:8px;
  }
  .input-row input {
    width:60%; padding:10px 14px;
    border-radius:10px; border:1px solid #d1d5db;
    font-size:1rem;
  }
  .input-row button {
    background:var(--blue); color:white; border:none; padding:10px 16px;
    border-radius:10px; font-weight:600; cursor:pointer;
  }

  /* === Animation === */
  .flash-correct { background:#dcfce7 !important; transition:.3s; }
  .flash-wrong { background:#fee2e2 !important; transition:.3s; }

  .footer { margin-top:25px; text-align:center; font-size:0.9rem; color:#6b7280; }
  details { background:#f0f4ff; border-radius:10px; padding:10px; cursor:pointer; margin-top:20px; }
  summary { font-weight:600; }
</style>
</head>
<body>
  <div class="app">
    <h1>üéØ Vokabeltrainer</h1>
    <div class="divider"></div>

    <div class="controls">
      <label>Kategorie:
        <select id="category">
          <option value="Alle">Alle (gemischt)</option>
        </select>
      </label>
      <label>Modus:
        <select id="mode">
          <option value="mixed">Gemischt</option>
          <option value="toGerman">Englisch ‚Üí Deutsch</option>
          <option value="toEnglish">Deutsch ‚Üí Englisch</option>
        </select>
      </label>
      <label>Delay:
        <select id="delay">
          <option value="1000">1s</option>
          <option value="3000" selected>3s</option>
          <option value="5000">5s</option>
        </select>
      </label>
    </div>

    <div class="functions">
      <div class="kachel" id="learnBtn">‚úçÔ∏è Vokabel-Abfrage</div>
      <div class="kachel" id="last30Btn">üìò Letzte 30</div>
      <div class="kachel" id="cardsBtn">üß† Karteikarten <small><i>Mitdenker Edition</i></small></div>
    </div>

    <div id="progress" style="text-align:center; font-weight:600; margin-bottom:10px;"></div>

    <section id="stage">
      <div id="categoryChip" class="category"></div>
      <div id="word" class="word"></div>
      <div id="mitdenkerHint" class="hint" style="display:none;">Mitdenker Edition ‚Äì erkenne falsche Paare!</div>
      <div id="feedback" class="hint"></div>
      <div class="btn-group">
        <button class="btn btn-ok" id="btnRight">Richtig</button>
        <button class="btn btn-wrong" id="btnWrong">T√§uschung erkannt</button>
        <button class="btn btn-skip" id="btnSkip">√úberspringen</button>
      </div>
      <div class="input-row" id="inputRow" style="display:none;">
        <input type="text" id="inputAnswer" placeholder="√úbersetzung eingeben ‚Ä¶">
        <button id="submitAnswer">Eingabe</button>
      </div>
    </section>

    <div class="footer-buttons">
      <button onclick="window.location='vokabeln.html'">üìÇ Vokabeln</button>
      <button onclick="location.reload()">üîÑ Neustart</button>
    </div>

    <details>
      <summary>üÜï Zuletzt hinzugef√ºgt ‚ñæ</summary>
      <div id="recentList">‚Äì</div>
    </details>

    <div class="footer">¬© 2025 Beeferino ‚Äì Online Sync aktiv</div>
  </div>

<script>
(async()=>{
  const stage=document.getElementById("stage");
  const catChip=document.getElementById("categoryChip");
  const word=document.getElementById("word");
  const mitdenker=document.getElementById("mitdenkerHint");
  const feedback=document.getElementById("feedback");
  const btnR=document.getElementById("btnRight");
  const btnW=document.getElementById("btnWrong");
  const btnS=document.getElementById("btnSkip");
  const inputRow=document.getElementById("inputRow");
  const input=document.getElementById("inputAnswer");
  const submit=document.getElementById("submitAnswer");
  const progress=document.getElementById("progress");

  let vocab=[], round=[], i=0, errors=[], trap=false, correct="", offered="", askLang="EN", mode="learn";

  async function load(){
    try{
      const r=await fetch("https://beeferino.github.io/vokabeltrainer/vokabeln.json");
      vocab=await r.json();
    }catch{vocab=[["hammer","Hammer","Werkzeugkasten Mechaniker"],["ruler","Ma√üstab","Grundwerkzeuge Metallverarbeitung"]];}
  }

  function shuffle(a){for(let j=a.length-1;j>0;j--){const x=Math.floor(Math.random()*(j+1));[a[j],a[x]]=[a[x],a[j]];}}
  function next(){
    if(i>=round.length){alert("Fertig! Fehler: "+errors.length);stage.style.display="none";return;}
    stage.classList.remove("flash-correct","flash-wrong");
    const [en,de,cat]=round[i];
    catChip.textContent=cat;
    askLang=Math.random()<0.5?"EN":"DE";
    correct=askLang==="EN"?de:en;
    offered=correct;
    trap=false;
    // 30% T√§uschung mit falschem Gegenst√ºck anderer Sprache
    if(mode==="cards" && Math.random()<0.3){
      const pool=vocab.map(x=>askLang==="EN"?x[1]:x[0]);
      let wrong;do{wrong=pool[Math.floor(Math.random()*pool.length)];}while(wrong===correct);
      offered=wrong; trap=true;
    }
    word.textContent=askLang==="EN"?en:de;
    feedback.innerHTML=(mode==="cards")?"üí° "+offered:"";
    mitdenker.style.display=mode==="cards"?"block":"none";
    inputRow.style.display="none";
    updateProgress();
  }
  function updateProgress(){progress.textContent=`Vokabel ${i+1}/${round.length} | Fehler: ${errors.length}`;}

  function flash(ok){stage.classList.add(ok?"flash-correct":"flash-wrong");setTimeout(()=>stage.classList.remove(ok?"flash-correct":"flash-wrong"),500);}
  btnR.onclick=()=>{
    if(mode==="cards"){
      const ok=!trap;
      if(!ok)errors.push("T√§uschung nicht erkannt");
      flash(ok);i++;setTimeout(next,parseInt(document.getElementById("delay").value));return;
    }
    inputRow.style.display="flex";
    input.focus();
  };
  btnW.onclick=()=>{
    if(mode!=="cards")return;
    if(trap){
      inputRow.style.display="flex";
      input.focus();
      submit.onclick=()=>{
        const ok=input.value.trim().toLowerCase()===correct.toLowerCase();
        if(!ok)errors.push("Korrektur falsch");
        flash(ok);i++;setTimeout(next,parseInt(document.getElementById("delay").value));
      };
    }else{
      errors.push("Falsch T√§uschung vermutet");
      flash(false);i++;setTimeout(next,parseInt(document.getElementById("delay").value));
    }
  };
  btnS.onclick=()=>{i++;next();};

  document.getElementById("learnBtn").onclick=()=>{mode="learn";start();};
  document.getElementById("cardsBtn").onclick=()=>{mode="cards";start();};
  document.getElementById("last30Btn").onclick=()=>{if(!vocab.length)return;round=vocab.slice(-30);mode=confirm("Mitdenker Edition?")?"cards":"learn";i=0;start(true);};

  function start(last=false){
    shuffle(vocab);round=last?round:vocab.slice(0,15);i=0;errors=[];stage.style.display="block";next();
  }
  await load();
})();
</script>
</body>
</html>
