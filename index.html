<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Vokabeltrainer ‚Äì Beeferino</title>
<style>
:root{
  --blue:#2563eb;--blue2:#1d4ed8;--ink:#0f172a;
  --glass:rgba(255,255,255,.88);--ok:#22c55e;--bad:#ef4444;--muted:#9ca3af;
}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,system-ui,sans-serif;background:linear-gradient(145deg,#eef4ff,#dbeafe);color:var(--ink)}
.app{max-width:960px;margin:32px auto;padding:22px;background:var(--glass);border-radius:22px;box-shadow:0 10px 32px rgba(0,0,0,.10);backdrop-filter:blur(8px)}
h1{margin:0;text-align:center;font-size:2rem;font-weight:800;color:#1e3a8a}
.hr{width:160px;height:4px;background:var(--blue);border-radius:4px;margin:10px auto 20px}
.controls,.functions{display:flex;flex-wrap:wrap;justify-content:center;gap:12px}
.controls label{display:flex;align-items:center;gap:6px}
select{padding:8px 12px;border:1px solid #d1d5db;border-radius:10px;font-size:1rem}
.kachel{flex:1 1 240px;text-align:center;background:var(--blue);color:#fff;padding:14px 18px;border-radius:14px;font-weight:700;cursor:pointer;box-shadow:0 6px 16px rgba(37,99,235,.25);transition:transform .15s,background .15s}
.kachel small{font-weight:600;opacity:.9}
.kachel:hover{transform:translateY(-1px);background:var(--blue2)}
.progress{text-align:center;font-weight:700;margin:8px 0 12px;min-height:1.2em}
#stage{display:none;margin-top:14px;padding:28px;border-radius:20px;background:rgba(255,255,255,.95);box-shadow:inset 0 0 10px rgba(0,0,0,.05);text-align:center}
.chip{display:inline-block;font-weight:800;padding:8px 14px;border-radius:999px;margin-bottom:10px}
.word{font-size:1.9rem;font-weight:800;margin:8px 0 6px}
.offer{font-size:1.1rem;color:#1f2937;margin:6px 0 12px;min-height:1.3em}
.btnrow{display:flex;justify-content:center;gap:12px;flex-wrap:wrap}
.btn{border:none;border-radius:12px;padding:10px 20px;font-weight:700;font-size:1rem;cursor:pointer}
.ok{background:var(--ok);color:#fff}.bad{background:var(--bad);color:#fff}.skip{background:var(--muted);color:#fff}
.inprow{display:none;gap:8px;justify-content:center;margin-top:12px}
.inprow input{width:60%;min-width:260px;padding:10px 14px;border:1px solid #d1d5db;border-radius:12px;font-size:1rem}
.inprow button{background:var(--blue);color:#fff;border:none;border-radius:12px;padding:10px 16px;font-weight:700}
.flash-correct{animation:good .4s}.flash-wrong{animation:bad .4s}
@keyframes good{from{background:#dcfce7}to{background:rgba(255,255,255,.95)}}
@keyframes bad{from{background:#fee2e2}to{background:rgba(255,255,255,.95)}}
.footer-actions{display:flex;justify-content:space-between;gap:12px;margin-top:24px}
.footer-actions a,.footer-actions button{background:#eaf0ff;border:1px solid #dbe3ff;color:#1f2937;padding:10px 14px;border-radius:12px;font-weight:700;cursor:pointer;text-decoration:none}
details{background:#f0f4ff;border-radius:12px;padding:10px 12px;margin-top:18px;text-align:center}
summary{font-weight:700;cursor:pointer}
#recent{margin-top:10px;text-align:center;line-height:1.6}
.foot{text-align:center;margin-top:14px;color:#6b7280;font-size:.92rem}
.feedback-toggle{display:flex;align-items:center;justify-content:center;gap:6px;margin-bottom:10px}
@media (hover:none){.kachel:active{transform:scale(.98)}}
</style>
</head>
<body>
<div class="app">
  <h1>üéØ Vokabeltrainer</h1>
  <div class="hr"></div>

  <div class="controls">
    <label>Kategorie:
      <select id="selCat"><option value="Alle">Alle (bunt gemischt)</option></select>
    </label>
    <label>Modus:
      <select id="selMode">
        <option value="mixed">Gemischt</option>
        <option value="toGerman">Englisch ‚Üí Deutsch</option>
        <option value="toEnglish">Deutsch ‚Üí Englisch</option>
      </select>
    </label>
    <label>Delay:
      <select id="selDelay">
        <option value="1000">1 s</option>
        <option value="3000" selected>3 s</option>
        <option value="5000">5 s</option>
      </select>
    </label>
  </div>

  <div class="feedback-toggle">
    <input type="checkbox" id="chkFeedback" checked>
    <label for="chkFeedback">Feedback anzeigen</label>
  </div>

  <div class="functions">
    <div id="btnLearn" class="kachel">‚úçÔ∏è Vokabel-Abfrage starten</div>
    <div id="btnLast30" class="kachel">üìó Letzte 30 Vokabeln</div>
    <div id="btnCards" class="kachel">üß† Karteikarten<br><small><i>Mitdenker Edition</i></small></div>
  </div>

  <div id="progress" class="progress"></div>

  <section id="stage">
    <div id="chip" class="chip">Kategorie</div>
    <div id="q" class="word"></div>
    <div id="offer" class="offer"></div>

    <div id="rowButtons" class="btnrow">
      <button id="btnRight" class="btn ok">Richtig</button>
      <button id="btnDec"   class="btn bad">T√§uschung erkannt</button>
      <button id="btnSkip"  class="btn skip">√úberspringen</button>
    </div>

    <div id="rowInput" class="inprow">
      <input id="inp" type="text" placeholder="√úbersetzung eingeben ‚Ä¶">
      <button id="btnSub">Eingabe</button>
    </div>
  </section>

  <div class="footer-actions">
    <a href="vokabeln.html">üìÇ Vokabeln</a>
    <button onclick="location.reload()">üîÑ Neustart</button>
  </div>

  <details>
    <summary>üÜï Zuletzt hinzugef√ºgt ‚ñæ</summary>
    <div id="recent">‚Äì</div>
  </details>

  <div class="foot">¬© 2025 Beeferino ‚Ä¢ Datenquelle: GitHub (Online)</div>
</div>

<script>
(function(){
const CATS={
  Gelb:["Grundwerkzeuge Metallverarbeitung","#F4D03F","#000"],
  Pink:["Werkzeugkasten Mechaniker","#E91E63","#fff"],
  Blau:["Blech- / Kunststoffarbeiten","#1976D2","#fff"],
  Gruen:["Drehen / Fr√§sen","#1E8449","#fff"],
  HellesPink:["Hydraulik / Pneumatik","#F54927","#fff"],
  Orange:["Elektrotechnik","#E67E22","#fff"],
  Dunkelgruen:["Flugger√§temechanik allgemein","#117A65","#fff"],
  Rot:["Verwechslungsgefahr","#C0392B","#fff"]
};
const el=(id)=>document.getElementById(id);
const selCat=el("selCat"), selDelay=el("selDelay"), chkFeedback=el("chkFeedback");
const btnLearn=el("btnLearn"), btnCards=el("btnCards"), btnLast30=el("btnLast30");
const progress=el("progress"), stage=el("stage"), chip=el("chip"), q=el("q"), offer=el("offer");
const btnRight=el("btnRight"), btnDec=el("btnDec"), btnSkip=el("btnSkip");
const rowButtons=el("rowButtons"), rowInput=el("rowInput"), inp=el("inp"), btnSub=el("btnSub"), recent=el("recent");

for(const k in CATS){const o=document.createElement("option");o.value=k;o.textContent=CATS[k][0];o.style.background=CATS[k][1];o.style.color=CATS[k][2];selCat.appendChild(o);}

let data=[], round=[], i=0, mode="learn", errors=0, trap=false, correct="", delay=3000;

async function loadData(){
  try{
    const r=await fetch("https://beeferino.github.io/vokabeltrainer/vokabeln.json",{cache:"no-store"});
    data=await r.json();
    localStorage.setItem("vokabeln",JSON.stringify(data));
  }catch{
    data=JSON.parse(localStorage.getItem("vokabeln")||"[]");
  }
  const last=data.slice(-5).reverse();
  recent.innerHTML = last.length
    ? last.map(v=>`<div><b>${v[0]}</b> ‚Äì ${v[1]} <span style="opacity:.7">(${CATS[v[2]]?CATS[v[2]][0]:v[2]})</span></div>`).join("")
    : "‚Äì";
}

function shuffle(a){for(let j=a.length-1;j>0;j--){const r=Math.floor(Math.random()*(j+1));[a[j],a[r]]=[a[r],a[j]];}}
function pick(list){let l=selCat.value==="Alle"?list:list.filter(v=>v[2]===selCat.value);shuffle(l);return l.slice(0,15);}
function setProg(){progress.textContent=`Vokabel ${i+1}/${round.length} | Fehler: ${errors}`;}
function showStage(show){stage.style.display = show ? "block":"none";}
function flash(ok){
  if(!chkFeedback.checked){i++;return next();}
  stage.classList.add(ok?"flash-correct":"flash-wrong");
  setTimeout(()=>{stage.classList.remove(ok?"flash-correct":"flash-wrong");i++;next();}, delay);
}

function next(){
  if(i>=round.length){showStage(false);alert(`Fertig! Fehler: ${errors}`);return;}
  delay=parseInt(selDelay.value,10);
  const [en,de,cat] = round[i];
  const catMeta=CATS[cat]||["Kategorie","#ddd","#000"];
  chip.textContent=catMeta[0]; chip.style.background=catMeta[1]; chip.style.color=catMeta[2];
  const askEN = Math.random()<0.5;
  const question = askEN ? en : de;
  const answer   = askEN ? de : en;
  correct = answer;
  q.textContent = question;

  if(mode==="cards"){
    trap=false;
    if(Math.random()<0.3){
      const pool=data.map(v=> askEN ? v[1] : v[0]);
      let wrong; do{ wrong = pool[Math.floor(Math.random()*pool.length)]; } while(wrong===answer);
      offer.textContent="üí° "+wrong;
      trap=true;
    }else{
      offer.textContent="üí° "+answer;
    }
    rowButtons.style.display="flex";
    btnRight.style.display="inline-block";
    btnDec.style.display="inline-block";
    btnSkip.style.display="inline-block";
    rowInput.style.display="none";
    inp.value="";
  } else {
    offer.textContent="";
    trap=false;
    rowButtons.style.display="flex";
    btnRight.style.display="none";
    btnDec.style.display="none";
    btnSkip.style.display="inline-block";
    rowInput.style.display="flex";
    inp.value=""; inp.focus();
  }
  setProg();
  showStage(true);
}

/* Buttons */
btnRight.onclick=()=>{const ok=!trap;if(!ok)errors++;flash(ok);};
btnDec.onclick=()=>{if(mode!=="cards")return;if(trap){rowInput.style.display="flex";inp.focus();}else{errors++;flash(false);}};
btnSkip.onclick=()=>{i++;next();};
btnSub.onclick=()=>{const ok=inp.value.trim().toLowerCase()===correct.toLowerCase();if(!ok)errors++;flash(ok);};
inp.addEventListener("keydown",e=>{if(e.key==="Enter")btnSub.click();});

/* Spielstart */
btnLearn.onclick=()=>{mode="learn";i=0;errors=0;round=pick(data);next();};
btnCards.onclick=()=>{mode="cards";i=0;errors=0;round=pick(data);next();};
btnLast30.onclick=()=>{
  const l=data.slice(-30);if(!l.length)return alert("Keine Vokabeln vorhanden");
  mode=confirm("Mitdenker Edition aktivieren?\nOK = Karteikarten ‚Ä¢ Abbrechen = Eingabe")?"cards":"learn";
  round=l;i=0;errors=0;next();
};
loadData();
})();
</script>
</body>
</html>
