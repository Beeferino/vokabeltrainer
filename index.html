<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ğŸ“˜ Beeferino Vokabeltrainer</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
:root{
  --bg:linear-gradient(145deg,#eef4ff,#dbeafe);
  --card:rgba(255,255,255,0.85);
  --border:#e2e8f0;
  --accent:#2563eb;
  --text:#1e293b;
  --muted:#64748b;
  --ok:#16a34a;
  --bad:#ef4444;
  --shadow:0 8px 26px rgba(0,0,0,.1);
}
body{margin:0;font-family:Inter,system-ui,sans-serif;background:var(--bg);color:var(--text)}
.app{max-width:1100px;margin:20px auto;padding:16px}
h1{text-align:center;font-weight:800;color:#1e3a8a}
.hr{width:160px;height:4px;background:var(--accent);border-radius:4px;margin:10px auto 20px}
.section{background:var(--card);border:1px solid var(--border);border-radius:20px;padding:18px;margin-bottom:20px;box-shadow:var(--shadow);backdrop-filter:blur(10px)}
button,select,input{font-family:inherit}
button{cursor:pointer;border:none;border-radius:10px;padding:10px 16px;font-weight:700;transition:all .2s ease}
button:hover{transform:translateY(-1px);box-shadow:0 2px 6px rgba(0,0,0,.08)}
.btn{background:var(--accent);color:#fff}
.btn.secondary{background:#475569}
.btn.red{background:var(--bad)}
select,input[type="number"]{padding:8px 12px;border-radius:10px;border:1px solid #cbd5e1}
.game-area{display:none;background:var(--card);border-radius:20px;box-shadow:var(--shadow);padding:24px;text-align:center;animation:fadeIn .5s ease}
.card{font-size:1.8rem;font-weight:800;margin:20px 0;border-radius:16px;padding:24px;color:#fff;transition:background .6s ease,color .6s ease}
.feedback{font-size:1.1rem;margin-top:10px;color:var(--muted)}
.footer{text-align:center;margin-top:20px;color:var(--muted);font-size:.9rem}
.category-select{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;align-items:center;position:relative}
.feedback-toggle{position:absolute;right:0;top:0}
.toggle-btn{background:#94a3b8;color:#fff;border-radius:999px;padding:6px 14px;font-weight:700;font-size:.9rem;transition:all .2s}
.toggle-btn.active{background:var(--accent)}
.correct{animation:flashGreen .3s}
.wrong{animation:flashRed .3s}
@keyframes flashGreen{0%{background:#bbf7d0}100%{background:transparent}}
@keyframes flashRed{0%{background:#fecaca}100%{background:transparent}}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
/* --- Mobile Anpassung --- */
@media(max-width:900px){
  .feedback-toggle{position:static;text-align:center;margin-top:10px}
}
</style>
</head>
<body>
<div class="app">
<h1>ğŸ¯ Beeferino Vokabeltrainer</h1>
<div class="hr"></div>

<div class="section">
  <div class="category-select">
    <select id="category">
      <option value="Alle">Alle (bunt gemischt)</option>
      <option value="Gelb">Grundwerkzeuge Metallverarbeitung</option>
      <option value="Pink">Werkzeugkasten Mechaniker</option>
      <option value="Blau">Blech- / Kunststoffarbeiten</option>
      <option value="Gruen">Drehen / FrÃ¤sen</option>
      <option value="HellesPink">Hydraulik / Pneumatik</option>
      <option value="Orange">Elektrotechnik</option>
      <option value="Dunkelgruen">FluggerÃ¤temechanik allgemein</option>
      <option value="Rot">âš ï¸ Verwechslungsgefahr</option>
    </select>
    <select id="mode">
      <option value="toGerman">Englisch â†’ Deutsch</option>
      <option value="toEnglish">Deutsch â†’ Englisch</option>
      <option value="mixed">Gemischt</option>
    </select>
    <select id="delay">
      <option value="1000">1 Sekunde</option>
      <option value="3000" selected>3 Sekunden</option>
      <option value="5000">5 Sekunden</option>
    </select>
  </div>
  <!-- Feedback Button unter Auswahl (Mobile sichtbar, Desktop bleibt oben) -->
  <div class="feedback-toggle">
    <button id="feedbackBtn" class="toggle-btn active">Feedback: AN</button>
  </div>
  <div style="display:flex;justify-content:center;flex-wrap:wrap;gap:12px;margin-top:16px">
    <button id="learnBtn" class="btn">âœï¸ Vokabel-Abfrage starten</button>
    <button id="cardsBtn" class="btn secondary">ğŸ§  Karteikarten (Mitdenker)</button>
    <button id="last30Btn" class="btn red">ğŸ“š Letzte 30 Vokabeln</button>
  </div>
</div>

<div class="game-area" id="trainer">
  <div class="card" id="word"></div>
  <input id="answerInput" type="text" placeholder="Ãœbersetzung eingeben â€¦" style="display:none;padding:10px;border-radius:10px;border:1px solid #ccc;width:60%;font-size:1rem">
  <div id="feedback" class="feedback"></div>
  <div style="margin-top:14px">
    <button id="rightBtn" style="display:none" class="btn">Richtig</button>
    <button id="wrongBtn" style="display:none" class="btn red">TÃ¤uschung erkannt</button>
    <button id="skipBtn" style="display:none" class="btn secondary">Weiter</button>
  </div>
  <div style="margin-top:18px"><button id="restartBtn" class="btn secondary">ğŸ”„ Neustart</button></div>
</div>

<div id="result" style="display:none" class="section"></div>

<div class="footer">
  <hr style="width:60%;opacity:.2;margin:20px auto">
  <a href="vokabeln.html" style="font-weight:700;color:#2563eb;text-decoration:none;">ğŸ“˜ Vokabelliste Ã¶ffnen</a><br>
  <p>Â© 2025 Beeferino â€¢ Online-Datenquelle: GitHub</p>
</div>
</div>

<script>
document.addEventListener("DOMContentLoaded",()=>{
const C={"Gelb":"Grundwerkzeuge Metallverarbeitung","Pink":"Werkzeugkasten Mechaniker","Blau":"Blech- / Kunststoffarbeiten","Gruen":"Drehen / FrÃ¤sen","HellesPink":"Hydraulik / Pneumatik","Orange":"Elektrotechnik","Dunkelgruen":"FluggerÃ¤temechanik allgemein","Rot":"Verwechslungsgefahr"};
const M={"Gelb":"#F4D03F","Pink":"#E91E63","Blau":"#1976D2","Gruen":"#1E8449","HellesPink":"#F54927","Orange":"#E67E22","Dunkelgruen":"#117A65","Rot":"#C0392B"};
const TEXT={"Gelb":"#000","Pink":"#fff","Blau":"#fff","Gruen":"#fff","HellesPink":"#fff","Orange":"#fff","Dunkelgruen":"#fff","Rot":"#fff"};
const url="https://beeferino.github.io/vokabeltrainer/vokabeln.json";
const el={
  cat:document.getElementById("category"),
  mode:document.getElementById("mode"),
  delay:document.getElementById("delay"),
  fbBtn:document.getElementById("feedbackBtn"),
  learn:document.getElementById("learnBtn"),
  cards:document.getElementById("cardsBtn"),
  last:document.getElementById("last30Btn"),
  restart:document.getElementById("restartBtn"),
  trainer:document.getElementById("trainer"),
  word:document.getElementById("word"),
  ans:document.getElementById("answerInput"),
  fb:document.getElementById("feedback"),
  right:document.getElementById("rightBtn"),
  wrong:document.getElementById("wrongBtn"),
  skip:document.getElementById("skipBtn"),
  result:document.getElementById("result")
};
let list=[],round=[],i=0,errors=[],skipped=[],mode="mixed",game="learn",trap=false,curr="",feedbackOn=true;

el.fbBtn.onclick=()=>{
  feedbackOn=!feedbackOn;
  el.fbBtn.classList.toggle("active",feedbackOn);
  el.fbBtn.textContent=feedbackOn?"Feedback: AN":"Feedback: AUS";
};

async function load(){
  try{const r=await fetch(url,{cache:"no-store"});list=await r.json();}
  catch{list=JSON.parse(localStorage.getItem("vokabeln")||"[]");}
}
function flash(c){el.trainer.classList.add(c);setTimeout(()=>el.trainer.classList.remove(c),400);}
function start(sel,type,custom=null){
  mode=sel;game=type;
  let data=list;
  if(el.cat.value!=="Alle") data=data.filter(v=>v[2]===el.cat.value);
  if(custom) data=custom;
  round=data.slice(0,15);
  i=0;errors=[];skipped=[];
  el.trainer.style.display="block";
  el.result.style.display="none";
  showNext();
}
function showNext(){
  if(i>=round.length){
    if(skipped.length){round=skipped;skipped=[];i=0;el.fb.textContent="ğŸ“˜ Ãœbersprungene Vokabeln â€“ weiter gehtâ€™s!";showNext();return;}
    el.trainer.style.display="none";
    let h="<h3>Runde beendet</h3>";
    h+=errors.length?`<p>${errors.length} Fehler:</p><ul>${errors.map(([q,a])=>`<li>${q} â†’ ${a}</li>`).join("")}</ul>`:"<p>Keine Fehler ğŸ‰</p>";
    el.result.innerHTML=h;el.result.style.display="block";return;
  }
  const [en,de,catg]=round[i];
  let ask,answ;
  if(mode==="toGerman"){ask=en;answ=de}
  else if(mode==="toEnglish"){ask=de;answ=en}
  else{if(Math.random()<.5){ask=en;answ=de}else{ask=de;answ=en}}
  // Karteikarte farbig + Textfarbe
  el.word.style.background=M[catg];
  el.word.style.color=TEXT[catg];
  el.word.innerHTML=`<div style='font-size:1.2rem;margin-bottom:8px'>${C[catg]}</div><b>${ask}</b>`;
  el.fb.textContent="";
  const delay=parseInt(el.delay.value);
  if(game==="learn"){
    el.ans.style.display="inline-block";
    el.right.style.display=el.wrong.style.display="none";
    el.skip.style.display="inline-block";
    el.ans.value="";el.ans.focus();
    el.ans.onkeydown=e=>{
      if(e.key==="Enter"){
        const ok=el.ans.value.trim().toLowerCase()===answ.toLowerCase();
        if(feedbackOn){el.fb.textContent=ok?"âœ… Richtig!":`âŒ Falsch â†’ ${answ}`;flash(ok?"correct":"wrong")}
        if(!ok)errors.push([ask,answ]);
        i++;setTimeout(showNext,delay);
      }
    };
    el.skip.onclick=()=>{skipped.push([en,de,catg]);i++;showNext();}
  }else{
    el.ans.style.display="none";
    el.right.style.display=el.wrong.style.display=el.skip.style.display="inline-block";
    trap=Math.random()<.3;curr=trap?getWrong(answ):answ;
    el.fb.innerHTML=`ğŸ’¡ <b>${curr}</b>`;
    const okBtn=trap?el.wrong:el.right;
    okBtn.onclick=()=>{if(trap){openInput(answ,ask)}else{nextCard(true,ask,answ)}};
    const failBtn=trap?el.right:el.wrong;
    failBtn.onclick=()=>nextCard(false,ask,answ);
    el.skip.onclick=()=>{skipped.push([en,de,catg]);i++;showNext();}
  }
}
function openInput(correct,ask){
  el.ans.style.display="inline-block";el.ans.value="";
  el.fb.textContent="Gib die richtige Ãœbersetzung ein:";
  el.right.style.display=el.wrong.style.display="none";
  el.ans.onkeydown=e=>{
    if(e.key==="Enter"){
      const ok=el.ans.value.trim().toLowerCase()===correct.toLowerCase();
      if(feedbackOn){el.fb.textContent=ok?"âœ… Richtig!":`âŒ Falsch â†’ ${correct}`;flash(ok?"correct":"wrong")}
      if(!ok)errors.push([ask,correct]);
      i++;setTimeout(showNext,parseInt(el.delay.value));
    }
  };
}
function nextCard(ok,ask,answ){
  if(feedbackOn){el.fb.textContent=ok?"âœ… Richtig!":"âŒ Falsch!";flash(ok?"correct":"wrong")}
  if(!ok)errors.push([ask,answ]);
  i++;setTimeout(showNext,parseInt(el.delay.value));
}
function getWrong(c){let p=list.map(v=>v[1]);let w;do{w=p[Math.floor(Math.random()*p.length)]}while(w===c);return w;}
el.learn.onclick=()=>start(el.mode.value,"learn");
el.cards.onclick=()=>start(el.mode.value,"cards");
el.last.onclick=()=>{const a=list;if(!a.length)return alert("Keine Vokabeln.");const l=a.slice(-30);const ch=confirm("ğŸ“š Letzte 30 Vokabeln:\nOK = Karteikarten\nAbbrechen = Eingabe");start(el.mode.value,ch?"cards":"learn",l)};
el.restart.onclick=()=>location.reload();
load();
});
</script>
</body>
</html>
