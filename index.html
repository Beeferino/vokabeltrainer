<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ğŸ¯ Vokabeltrainer â€“ Beeferino</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
:root {
  --blue:#2563eb; --bg:#f1f5f9; --card:#fff;
  --ok:#22c55e; --bad:#ef4444; --muted:#6b7280;
  --shadow:0 10px 30px rgba(0,0,0,.1);
}
* {box-sizing:border-box}
body {
  margin:0; background:linear-gradient(145deg,#eef4ff,#dbeafe);
  font-family:Inter,system-ui,sans-serif; color:#0f172a;
}
.container {
  max-width:1050px; margin:20px auto; background:var(--card);
  border-radius:18px; box-shadow:var(--shadow);
  padding:20px; text-align:center;
}
h1 {font-weight:800; color:#1e3a8a; margin-bottom:5px;}
.hr {width:140px; height:4px; background:var(--blue);
  margin:8px auto 20px; border-radius:4px;}

select, input[type="checkbox"] {
  padding:8px 12px; border-radius:8px;
  border:1px solid #cbd5e1; font-size:1rem;
}
button {
  cursor:pointer; border:none; border-radius:10px;
  font-weight:700; transition:.2s; box-shadow:0 4px 10px rgba(0,0,0,.05);
}
button:hover {opacity:.9}
.btn {
  background:var(--blue); color:#fff; padding:10px 18px; margin:6px;
}
.mode-btn {
  display:inline-flex; align-items:center; justify-content:center;
  background:var(--blue); color:#fff; padding:14px 20px; font-size:1.05rem;
  margin:10px; border-radius:12px; box-shadow:var(--shadow);
}
.mode-btn:hover {transform:translateY(-1px);}

.status {font-weight:600; margin:8px 0;}
.footer {
  font-size:.85rem; color:var(--muted);
  text-align:center; margin-top:25px;
}

/* Feedback Toggle */
.feedback-toggle {
  display:flex; align-items:center; justify-content:center; gap:8px;
  background:#f8fafc; border-radius:12px; box-shadow:inset 0 0 6px rgba(0,0,0,.05);
  width:max-content; margin:14px auto; padding:8px 16px;
  font-weight:600;
}
.feedback-toggle input {transform:scale(1.3); cursor:pointer;}

/* Karteikarten */
.card {
  margin:25px auto; width:60%; min-height:120px;
  background:#d1fae5; border-radius:20px; box-shadow:var(--shadow);
  display:flex; align-items:center; justify-content:center;
  font-size:1.6rem; font-weight:700; color:#064e3b;
  cursor:pointer; transition:transform .5s;
}
.card.flip {transform:rotateY(180deg);}
.card.red {border:3px solid var(--bad);}

/* Statistik */
.stats {margin-top:10px; font-size:.95rem; color:#444;}

#feedbackBtn {
  background:#fff; border:1px solid #cbd5e1;
  border-radius:10px; padding:10px 20px;
  box-shadow:var(--shadow); margin:10px 0;
}

/* Responsive */
@media(max-width:700px){
  .card{width:90%;font-size:1.4rem;}
}
</style>
</head>

<body>
<div class="container">
  <h1>ğŸ¯ Vokabeltrainer</h1>
  <div class="hr"></div>

  <div class="controls">
    <label>Kategorie:
      <select id="selCat">
        <option value="Alle">Alle (bunt gemischt)</option>
      </select>
    </label>
    <label>Modus:
      <select id="selMode">
        <option value="mixed">Gemischt</option>
        <option value="toGerman">Englisch â†’ Deutsch</option>
        <option value="toEnglish">Deutsch â†’ Englisch</option>
      </select>
    </label>
    <label>Delay:
      <select id="selDelay">
        <option value="1000">1 s</option>
        <option value="3000" selected>3 s</option>
        <option value="5000">5 s</option>
      </select>
    </label>
  </div>

  <div class="toolbar">
    <button id="btnErrorsOnly" class="btn">ğŸ” Fehler wiederholen</button>
    <button id="btnStats" class="btn">ğŸ“Š Statistik</button>
    <label class="feedback-toggle"><input type="checkbox" id="chkFeedback"> Feedback anzeigen</label>
  </div>

  <div class="mode-buttons">
    <button id="btnLearn" class="mode-btn">ğŸ”¥ Vokabel-Abfrage starten</button>
    <button id="btnLast30" class="mode-btn">ğŸ•“ Letzte eingegebene Vokabeln</button>
    <button id="btnCards" class="mode-btn">ğŸ§  Karteikarten</button>
  </div>

  <div id="statusArea" class="status">Bereit.<br>WÃ¤hle einen der drei Modi aus, um zu starten: <b>Vokabel-Abfrage</b>, <b>Letzte Vokabeln</b> oder <b>Karteikarten</b>.</div>

  <div id="cardArea"></div>
  <div class="stats" id="statArea"></div>

  <div class="footer">
    Â© 2025 Beeferino â€¢ <span id="syncLabel">ğŸŸ¢ Daten aktuell</span>
  </div>
</div>

<script>
// =====================================================
// BASISDATEN UND KONSTANTEN
// =====================================================
const $=s=>document.querySelector(s);
const CATS={
  Gelb:["Grundwerkzeuge Metallverarbeitung","#F4D03F","#000"],
  Pink:["Werkzeugkasten Mechaniker","#E91E63","#fff"],
  Blau:["Blech- / Kunststoffarbeiten","#1976D2","#fff"],
  Gruen:["Drehen / FrÃ¤sen","#1E8449","#fff"],
  HellesPink:["Hydraulik / Pneumatik","#F54927","#fff"],
  Orange:["Elektrotechnik","#E67E22","#fff"],
  Dunkelgruen:["FluggerÃ¤temechanik allgemein","#117A65","#fff"]
};
let data=[],errors=[],index=0,correct=0,total=0,wrongAnswers=[];

// =====================================================
// DATEN LADEN UND NORMALISIEREN
// =====================================================
async function fetchFromGitHub(){
  const url="https://beeferino.github.io/vokabeltrainer/vokabeln.json";
  try{
    const r=await fetch(url,{cache:"no-store"}); if(!r.ok) throw new Error("fetch failed");
    const j=await r.json();
    data = j.map(v=>[
      v[0]||"", v[1]||"", v[2]||"Gelb",
      v[3]||"", v[4]||"", v[5]||new Date().toISOString(),
      !!v[6] // Flag fÃ¼r Verwechslungsgefahr
    ]);
    localStorage.setItem("vokabeln",JSON.stringify(data));
    localStorage.setItem("vokabeln_updated",new Date().toISOString());
  }catch(e){
    data = (JSON.parse(localStorage.getItem("vokabeln")||"[]")).map(v=>[
      v[0]||"", v[1]||"", v[2]||"Gelb",
      v[3]||"", v[4]||"", v[5]||new Date().toISOString(),
      !!v[6]
    ]);
  }
  buildCatOptions();
}

// =====================================================
// DROPDOWN-FUNKTIONEN
// =====================================================
function buildCatOptions(){
  const sel=$("#selCat");
  sel.innerHTML='<option value="Alle">Alle (bunt gemischt)</option>';
  for(const k in CATS){
    const [label,bg,fg]=CATS[k];
    const o=document.createElement("option");
    o.value=k; o.textContent=label;
    o.style.background=bg; o.style.color=fg;
    sel.appendChild(o);
  }
  // âš ï¸ Spezialfilter fÃ¼r Verwechslungsgefahr-Vokabeln
  const dangerOpt=document.createElement("option");
  dangerOpt.value="confuse";
  dangerOpt.textContent="âš ï¸ Verwechslungsgefahr-Vokabeln";
  dangerOpt.style.background="#ffe4e6";
  dangerOpt.style.color="#b91c1c";
  sel.appendChild(dangerOpt);
}

function filterByCategory(list){
  const cat=$("#selCat").value;
  if(cat==="Alle") return list.slice();
  if(cat==="confuse") return list.filter(v=>!!v[6]);
  return list.filter(v=>v[2]===cat);
}

// =====================================================
// ANZEIGE / KARTEN / ABFRAGE
// =====================================================
function showCard(front,back,isDanger=false){
  const area=$("#cardArea");
  area.innerHTML="";
  const div=document.createElement("div");
  div.className="card"+(isDanger?" red":"");
  div.textContent=front;
  area.appendChild(div);

  div.onclick=()=>{
    if(div.textContent===front){div.textContent=back;}
    else{div.textContent=front;}
  };
}

function nextCard(list,mode,delay){
  if(index>=list.length){
    $("#statusArea").innerHTML=`ğŸ‰ Runde beendet.<br>Richtig: ${correct}/${total}`;
    return;
  }
  const v=list[index];
  const isDanger=!!v[6];
  const question=mode==="toGerman"?v[0]:(mode==="toEnglish"?v[1]:Math.random()<0.5?v[0]:v[1]);
  const answer=(question===v[0]?v[1]:v[0]);
  showCard(question,answer,isDanger);
  total++;
}

// =====================================================
// MODI STARTEN
// =====================================================
$("#btnLearn").onclick=()=>startMode("all");
$("#btnLast30").onclick=()=>startMode("last");
$("#btnCards").onclick=()=>startMode("cards");

function startMode(type){
  let list=filterByCategory(data);
  if(type==="last") list=list.slice(-30);
  index=0; correct=0; total=0; wrongAnswers=[];
  const delay=parseInt($("#selDelay").value);
  const mode=$("#selMode").value;
  const shuffleList=shuffle(list);
  nextCard(shuffleList,mode,delay);
}

function shuffle(a){return a.sort(()=>Math.random()-.5);}

// =====================================================
// INITIALISIERUNG
// =====================================================
fetchFromGitHub();
</script>
</body>
</html>
