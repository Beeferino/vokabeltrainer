<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üéØ Vokabeltrainer</title>

<style>
body {
  font-family: "Inter", system-ui, sans-serif;
  background: #f5f7fb;
  margin: 0;
  padding: 0;
  color: #222;
}
.app {
  max-width: 900px;
  margin: 20px auto;
  background: #fff;
  padding: 1.5rem 2rem;
  border-radius: 16px;
  box-shadow: 0 10px 25px rgba(0,0,0,.08);
}
h1 {
  text-align: center;
  margin-bottom: .5rem;
}
.divider {
  border: none;
  border-top: 2px solid #e0e0e0;
  margin-bottom: 1rem;
}
.controls {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 1rem;
  margin-bottom: 1rem;
}
.controls label {
  font-weight: 500;
}
select {
  margin-left: .4rem;
  padding: .35rem .55rem;
  border-radius: 8px;
  border: 1px solid #ccc;
  font-size: .95rem;
  background: #fff;
}

.functions {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 1rem;
  margin-bottom: 1.5rem;
}
.kachel {
  background: #f1f3f8;
  border-radius: 12px;
  padding: .9rem 1.4rem;
  cursor: pointer;
  font-weight: 600;
  box-shadow: 0 2px 6px rgba(0,0,0,.08);
  transition: all .15s ease;
}
.kachel:hover {
  background: #eef1fb;
  transform: translateY(-2px);
}

.card {
  text-align: center;
  padding: 1.5rem;
  border-radius: 14px;
  background: #fafafa;
  box-shadow: 0 3px 10px rgba(0,0,0,.06);
  margin-bottom: 1rem;
}
.word b {
  font-size: 1.5rem;
}

.feedback {
  margin-top: 1rem;
  font-size: 1rem;
}

#cardButtons {
  margin-top: 1rem;
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: .6rem;
}

#cardButtons button {
  border: none;
  border-radius: 12px;
  padding: .6rem 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: all .15s ease;
}
#rightBtn { background: #27ae60; color: #fff; }
#trapBtn { background: #e67e22; color: #fff; }
#skipBtn { background: #95a5a6; color: #fff; }
#nextBtn {
  background: linear-gradient(180deg,#6366f1,#4f46e5);
  color: #fff;
}
#cardButtons button:hover {
  filter: brightness(1.05);
  transform: translateY(-1px);
}

.progress {
  text-align: center;
  font-weight: 500;
  margin-bottom: 1rem;
}

.footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.linkbtn {
  background: #4f46e5;
  color: #fff;
  padding: .6rem 1.2rem;
  border-radius: 12px;
  text-decoration: none;
  font-weight: 600;
  transition: all .15s ease;
}
.linkbtn:hover {
  filter: brightness(1.1);
}

#datasourceStatus {
  text-align: center;
  margin-top: .6rem;
  color: #777;
}

/* --- Sch√∂nes Eingabefeld --- */
.input-wrapper {
  display: inline-flex;
  align-items: center;
  gap: .5rem;
  padding: .5rem .6rem;
  border-radius: 14px;
  background: rgba(255,255,255,.75);
  border: 1px solid rgba(0,0,0,.06);
  box-shadow:
    0 2px 5px rgba(0,0,0,.05),
    0 8px 24px rgba(0,0,0,.08);
  backdrop-filter: blur(6px);
  transition: all .25s ease;
  margin-top: .7rem;
}
#answerInput {
  border: none;
  outline: none;
  font-size: 1rem;
  padding: .55rem .75rem;
  min-width: 260px;
  border-radius: 10px;
  background: #fff;
  box-shadow: inset 0 0 0 1px rgba(0,0,0,.08);
  transition: box-shadow .25s ease, transform .05s ease;
}
#answerInput:focus {
  box-shadow: inset 0 0 0 2px #4f46e5, 0 6px 18px rgba(79,70,229,.15);
}
.correct { animation: flashGreen .4s; }
.wrong { animation: flashRed .4s; }
@keyframes flashGreen { from{background:#c8f7c5;} to{background:#fafafa;} }
@keyframes flashRed { from{background:#f5b7b1;} to{background:#fafafa;} }
</style>
</head>

<body>
<div class="app">
 <h1>üéØ Vokabeltrainer</h1>
 <hr class="divider">
 <div class="controls">
   <label>Kategorie:
     <select id="category">
       <option value="Alle">Alle (bunt gemischt)</option>
       <option value="Gelb" style="background:#F4D03F;color:#fff">Grundwerkzeuge Metallverarbeitung</option>
       <option value="Pink" style="background:#E91E63;color:#fff">Werkzeugkasten Mechaniker</option>
       <option value="Blau" style="background:#1976D2;color:#fff">Blech- / Kunststoffarbeiten</option>
       <option value="Gruen" style="background:#1E8449;color:#fff">Drehen / Fr√§sen</option>
       <option value="HellesPink" style="background:#F54927;color:#fff">Hydraulik / Pneumatik</option>
       <option value="Orange" style="background:#E67E22;color:#fff">Elektrotechnik</option>
       <option value="Dunkelgruen" style="background:#117A65;color:#fff">Flugger√§temechanik allgemein</option>
       <option value="Rot" style="background:#C0392B;color:#fff">Verwechslungsgefahr</option>
     </select>
   </label>
   <label>Modus:
     <select id="mode">
       <option value="toGerman">Englisch ‚Üí Deutsch</option>
       <option value="toEnglish">Deutsch ‚Üí Englisch</option>
       <option value="mixed">Gemischt</option>
     </select>
   </label>
   <label>Delay:
     <select id="delaySelect">
       <option value="1000">1 s</option>
       <option value="3000" selected>3 s</option>
       <option value="5000">5 s</option>
     </select>
   </label>
 </div>

 <div class="functions">
   <div class="kachel" id="learnBtn">‚úçÔ∏è Vokabel-Abfrage starten</div>
   <div class="kachel" id="last30Btn">üìö Letzte 30 Vokabeln</div>
   <div class="kachel" id="cardsBtn">üß† Karteikarten starten<small> f√ºr Mitdenker</small></div>
 </div>

 <div class="trainer-area" id="trainer" style="display:none;">
   <div class="card" id="card">
     <div id="word" class="word"></div>
     <div id="hint" style="font-size:.9rem;color:#999;display:none;">üí≠ T√§uschung m√∂glich</div>

     <div class="input-wrapper" id="inputWrap" style="display:none;">
       <input id="answerInput" type="text" placeholder="√úbersetzung eingeben ‚Ä¶">
     </div>

     <div id="feedback" class="feedback"></div>

     <div id="cardButtons">
       <button id="rightBtn" style="display:none;">Richtig</button>
       <button id="trapBtn" style="display:none;">T√§uschung erkannt</button>
       <button id="nextBtn" style="display:none;">Weiter</button>
       <button id="skipBtn" style="display:none;">√úberspringen</button>
     </div>
   </div>
 </div>

 <div id="progress" class="progress" style="display:none;">Vokabel 0/0 | Fehler: 0</div>
 <div id="result" style="display:none" class="card"></div>

 <div class="footer">
   <a href="vokabeln.html" class="linkbtn">üìò Vokabeln</a>
   <button id="restartBtn" class="linkbtn" style="background:#95a5a6">üîÑ Neustart</button>
 </div>
</div>

<div id="datasourceStatus">üåê Datenquelle: GitHub (Online)</div>

<script>
document.addEventListener("DOMContentLoaded",()=>{
 const status=document.getElementById("datasourceStatus"),
   cat=document.getElementById("category"),
   mSel=document.getElementById("mode"),
   delaySel=document.getElementById("delaySelect"),
   learn=document.getElementById("learnBtn"),
   cards=document.getElementById("cardsBtn"),
   last30=document.getElementById("last30Btn"),
   restart=document.getElementById("restartBtn"),
   word=document.getElementById("word"),
   feedback=document.getElementById("feedback"),
   progress=document.getElementById("progress"),
   trainer=document.getElementById("trainer"),
   result=document.getElementById("result"),
   ans=document.getElementById("answerInput"),
   inputWrap=document.getElementById("inputWrap"),
   hint=document.getElementById("hint"),
   card=document.getElementById("card"),
   right=document.getElementById("rightBtn"),
   trapBtn=document.getElementById("trapBtn"),
   nextBtn=document.getElementById("nextBtn"),
   skip=document.getElementById("skipBtn");

 const C={"Gelb":"Grundwerkzeuge Metallverarbeitung","Pink":"Werkzeugkasten Mechaniker","Blau":"Blech- / Kunststoffarbeiten","Gruen":"Drehen / Fr√§sen","HellesPink":"Hydraulik / Pneumatik","Orange":"Elektrotechnik","Dunkelgruen":"Flugger√§temechanik allgemein","Rot":"Verwechslungsgefahr"},
  M={"Gelb":"#F4D03F","Pink":"#E91E63","Blau":"#1976D2","Gruen":"#1E8449","HellesPink":"#F54927","Orange":"#E67E22","Dunkelgruen":"#117A65","Rot":"#C0392B"};
 let list=[],round=[],i=0,errors=[],skipped=[],mode="mixed",delay=3000,game="learn";

 async function sync(){
   try{
     const r=await fetch("https://beeferino.github.io/vokabeltrainer/vokabeln.json",{cache:"no-store"});
     list=await r.json();localStorage.setItem("vokabeln",JSON.stringify(list));
     status.textContent="üåê Datenquelle: GitHub (Online)";
   }catch{
     list=JSON.parse(localStorage.getItem("vokabeln")||"[]");
     status.textContent="üíæ Datenquelle: Lokal";
   }
 }

 function flash(cls){card.classList.add(cls);setTimeout(()=>card.classList.remove(cls),400);}
 function updateProg(){progress.style.display="block";progress.textContent=`Vokabel ${i+1}/${round.length} | Fehler: ${errors.length}`;}

 function start(sel,type,custom=null){
   if(!list.length){alert("Keine Vokabeln gefunden.");return;}
   game=type;mode=sel;delay=parseInt(delaySel.value,10);
   let f=cat.value==="Alle"?list:list.filter(v=>v[2]===cat.value);
   if(custom)f=custom;round=f.slice(0,15);
   i=0;errors=[];skipped=[];
   trainer.style.display="block";result.style.display="none";
   showNext();
 }

 function showNext(){
   ans.value="";
   ans.style.display="none";
   inputWrap.style.display="none";
   hint.style.display="none";
   right.style.display=trapBtn.style.display=nextBtn.style.display=skip.style.display="none";

   if(i>=round.length){
     trainer.style.display="none";
     progress.style.display="none";
     let h="<h3>Runde beendet</h3>";
     h+=errors.length?`<p>${errors.length} Fehler:</p><ul>${errors.map(([q,a])=>`<li>${q} ‚Üí ${a}</li>`).join("")}</ul>`:"<p>Keine Fehler üéâ</p>";
     result.innerHTML=h;result.style.display="block";return;
   }

   updateProg();
   const [en,de,catg]=round[i];
   let ask,answ;
   if(mode==="toGerman"){ask=en;answ=de;}
   else if(mode==="toEnglish"){ask=de;answ=en;}
   else{if(Math.random()<.5){ask=en;answ=de;}else{ask=de;answ=en;}}
   const c=M[catg]||"#ccc";
   word.innerHTML=`<div style="display:inline-block;padding:6px 12px;border-radius:12px;background:${c};color:#fff;">${C[catg]}</div><br><br><b>${ask}</b>`;
   feedback.textContent="";

   // Lernmodus / letzte 30
   if(game==="learn"||game==="last30"){
     inputWrap.style.display="inline-flex";
     ans.style.display="inline-block";
     ans.focus();
     inputWrap.animate([{opacity:0},{opacity:1}],{duration:200});
     nextBtn.style.display="inline-block";

     ans.onkeydown=(e)=>{if(e.key==="Enter")nextBtn.click();};
     nextBtn.onclick=()=>{
       const ok=ans.value.trim().toLowerCase()===answ.toLowerCase();
       flash(ok?"correct":"wrong");
       if(!ok)errors.push([ask,answ]);
       i++;setTimeout(showNext,delay);
     };
   } else {
     // Karteikarten-Modus
     right.style.display=trapBtn.style.display=skip.style.display="inline-block";
     hint.style.display="block";
     const trap=Math.random()<.4;
     const shown=trap?getWrong(answ):answ;
     feedback.textContent=shown;

     right.onclick=()=>{
       const ok=!trap;
       if(!ok)errors.push([ask,answ]);
       flash(ok?"correct":"wrong");
       i++;setTimeout(showNext,delay);
     };

     trapBtn.onclick=()=>{
       if(!trap){
         flash("wrong");errors.push([ask,answ]);
         i++;setTimeout(showNext,delay);
         return;
       }
       feedback.textContent="üí¨ Richtige √úbersetzung eingeben:";
       inputWrap.style.display="inline-flex";
       ans.style.display="inline-block";
       ans.value="";ans.focus();
       inputWrap.animate([{opacity:0},{opacity:1}],{duration:200});
       nextBtn.style.display="inline-block";

       ans.onkeydown=(e)=>{if(e.key==="Enter")checkInput();};
       nextBtn.onclick=checkInput;

       function checkInput(){
         const user=ans.value.trim().toLowerCase();
         const ok=user===answ.toLowerCase();
         flash(ok?"correct":"wrong");
         if(!ok)errors.push([ask,answ]);
         i++;setTimeout(showNext,delay);
       }
     };

     skip.onclick=()=>{skipped.push([en,de,catg]);i++;showNext();};
   }
 }

 function getWrong(correct){
   let pool=list.map(v=>v[1]);
   let w;
   do{w=pool[Math.floor(Math.random()*pool.length)];}while(w===correct);
   return w;
 }

 learn.onclick=()=>start(mSel.value,"learn");
 cards.onclick=()=>start(mSel.value,"cards");
 last30.onclick=()=>{if(!list.length){alert("Keine Vokabeln.");return;}const l=list.slice(-30);start(mSel.value,"last30",l);};
 restart.onclick=()=>location.reload();
 (async()=>{await sync();})();
});
</script>
</body>
</html>
