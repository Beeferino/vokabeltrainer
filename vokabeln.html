<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>📘 Vokabelübersicht – Beeferino</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<meta name="color-scheme" content="light dark">

<style>
/* =========================================================
   VOKABELN – LAYOUT & THEME (verbessert, responsive)
   ========================================================= */
:root {
  --bg: #f4f7ff;
  --card: #ffffff;
  --ink: #0f172a;
  --muted: #6b7280;
  --border: #dbe3ff;
  --shade: 0 10px 28px rgba(15, 23, 42, .08);
  --blue: #2563eb;
  --blue-2: #1d4ed8;
  --green: #16a34a;
  --red: #ef4444;
  --amber: #f59e0b;

  --chip-bg: #eef2ff;
  --chip-ink: #1e3a8a;

  --cat-Gelb: #F4D03F;
  --cat-Pink: #E91E63;
  --cat-Blau: #1976D2;
  --cat-Gruen: #1E8449;
  --cat-HellesPink: #F54927;
  --cat-Orange: #E67E22;
  --cat-Dunkelgruen: #117A65;

  --fade-ms: 280ms;
}

/* ==================== Dark Mode verbessert ==================== */
body.dark {
  --bg: #0d1424;
  --card: #111827;
  --ink: #f3f4f6;
  --muted: #9aa4b2;
  --border: #1e293b;
  --shade: 0 10px 30px rgba(0, 0, 0, .45);
  --chip-bg: #1e293b;
  --chip-ink: #dbeafe;
  background: radial-gradient(1200px 600px at 50% -100px, #0f172a 0%, #0a1120 60%), var(--bg);
  color: var(--ink);
}

* {
  box-sizing: border-box;
}
html, body {
  margin: 0;
  font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
  transition: background-color var(--fade-ms) ease, color var(--fade-ms) ease;
  background: radial-gradient(1200px 600px at 50% -100px, #dbeafe 0%, transparent 60%), var(--bg);
}

/* =========================================================
   Hauptcontainer
   ========================================================= */
.app {
  max-width: 1200px;
  margin: 22px auto 40px;
  padding: 10px 16px 40px;
}

/* =========================================================
   Header
   ========================================================= */
.h1 {
  display: flex;
  align-items: center;
  gap: 14px;
  justify-content: center;
  font-weight: 800;
  font-size: clamp(1.6rem, 2.3vw, 2.4rem);
  letter-spacing: .2px;
}
.h1 .icon {
  font-size: 1.8em;
}
.subbar {
  width: 220px;
  height: 6px;
  border-radius: 999px;
  margin: 8px auto 12px;
  background: linear-gradient(90deg, #60a5fa, #2563eb, #60a5fa);
  opacity: .9;
}

/* =========================================================
   Toolbar (inkl. schmalerer Sync-Button)
   ========================================================= */
.toolbar {
  display: grid;
  grid-template-columns: 1fr auto auto auto auto;
  gap: 10px;
  align-items: center;
  margin: 8px 0 14px;
}
@media (max-width: 900px) {
  .toolbar {
    grid-template-columns: 1fr 1fr;
  }
}

select, input[type="text"] {
  width: 100%;
  padding: 10px 12px;
  border: 1px solid var(--border);
  border-radius: 12px;
  background: var(--card);
  color: var(--ink);
  transition: border-color .2s ease, background-color var(--fade-ms) ease, color var(--fade-ms) ease;
}
input[type="text"]::placeholder { color: var(--muted); }

.btn {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  border: 1px solid var(--border);
  background: var(--card);
  color: var(--ink);
  padding: 10px 14px;
  border-radius: 12px;
  font-weight: 800;
  cursor: pointer;
  box-shadow: var(--shade);
  transition: transform .08s ease, background-color var(--fade-ms), color var(--fade-ms), border-color var(--fade-ms);
  user-select: none;
}
.btn:active { transform: translateY(1px); }
.btn.primary {
  background: linear-gradient(135deg, #3b82f6, #2563eb);
  color: #fff;
  border-color: transparent;
}
.btn.warn {
  background: linear-gradient(135deg, #f87171, #ef4444);
  color: #fff;
  border-color: transparent;
}
.btn.soft {
  background: linear-gradient(135deg, #eef2ff, #f8faff);
}
body.dark .btn.soft {
  background: #1e293b;
  color: #f3f4f6;
  border-color: #334155;
}
.btn.toggle-active { outline: 2px solid #60a5fa; }
.btn.small { padding: 8px 12px; border-radius: 10px; font-weight: 700; }
.btn.block { width: 100%; justify-content: center; }

/* --- kleinerer Sync-Button --- */
#btnSync {
  max-width: 220px;
  justify-self: end;
}
body.dark #btnSync {
  background: #1e293b;
  color: #e5e7eb;
  border-color: #334155;
}

/* =========================================================
   Zähler (zentriert)
   ========================================================= */
.count-row {
  display: flex;
  align-items: center;
  justify-content: center;
  flex-wrap: wrap;
  gap: 10px;
  margin: 8px 0 12px;
}
.badge {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  background: var(--chip-bg);
  color: var(--chip-ink);
  padding: 8px 12px;
  border-radius: 12px;
  font-weight: 800;
}

/* =========================================================
   Tabellen-Layout
   ========================================================= */
.table-wrap {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 16px;
  box-shadow: var(--shade);
  overflow: hidden;
}
table { width: 100%; border-collapse: collapse; }
thead th {
  text-align: left;
  font-weight: 800;
  padding: 14px 14px;
  background: linear-gradient(180deg, rgba(99,102,241,.06), transparent 60%);
  border-bottom: 1px solid var(--border);
}
tbody td {
  padding: 16px 14px;
  border-bottom: 1px solid var(--border);
}
tbody tr:hover { background: rgba(99,102,241,.05); }

.cell-english a {
  font-weight: 800;
  color: #2563eb;
  text-decoration: none;
}
.cell-english a:hover { text-decoration: underline; }

.cat-badge {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 10px;
  border-radius: 999px;
  font-weight: 800;
  font-size: .9rem;
  background: var(--chip-bg);
  color: var(--chip-ink);
  border: 1px solid var(--border);
}
body.dark .cat-badge {
  background: #1e293b;
  color: #dbeafe;
  border-color: #334155;
}
.cat-dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: #94a3b8;
}
.dot-Gelb { background: var(--cat-Gelb) }
.dot-Pink { background: var(--cat-Pink) }
.dot-Blau { background: var(--cat-Blau) }
.dot-Gruen { background: var(--cat-Gruen) }
.dot-HellesPink { background: var(--cat-HellesPink) }
.dot-Orange { background: var(--cat-Orange) }
.dot-Dunkelgruen { background: var(--cat-Dunkelgruen) }

.confuse-flag {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  margin-left: 10px;
  padding: 2px 8px;
  border-radius: 999px;
  font-weight: 800;
  font-size: .78rem;
  background: rgba(239,68,68,.10);
  color: #ef4444;
  border: 1px solid rgba(239,68,68,.25);
}
body.dark .confuse-flag {
  background: rgba(239,68,68,.2);
  border-color: rgba(239,68,68,.3);
  color: #fca5a5;
}
/* =========================================================
   Karten-Grid (Desktop-Kachelansicht)
   ========================================================= */
.grid {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr)); /* 2 Spalten Desktop */
  gap: 14px;
}
@media (max-width: 1100px) {
  .grid { grid-template-columns: 1fr; }          /* 1 Spalte bei kleiner Breite */
}
.card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 16px;
  box-shadow: var(--shade);
  padding: 16px;
  position: relative;
}
.card h3 {
  margin: 0 0 6px;
  font-size: 1.25rem;
  font-weight: 800;
}
.card .sub {
  margin: 0 0 10px;
  color: var(--muted);
}
.card .row {
  display: flex; align-items: center; gap: 10px; flex-wrap: wrap;
}
.card .chip {
  display: inline-flex; align-items: center; gap: 8px;
  padding: 6px 10px; border-radius: 999px;
  background: var(--chip-bg); color: var(--chip-ink);
  border: 1px solid var(--border); font-weight: 800;
}
.card .hint { color: var(--muted); }

/* „Bearbeiten“-Button rechts oben in der Karte */
.card .edit {
  position: absolute; top: 10px; right: 10px;
  opacity: .9;
}

/* =========================================================
   Pagination (zentriert, 15/Seite)
   ========================================================= */
.pagination {
  display: flex; align-items: center; justify-content: center; gap: 10px;
  margin: 14px 0 6px;
}
.pagination .btn { min-width: 100px; }
.page-info { font-weight: 800; color: var(--muted); }

/* =========================================================
   Bottom Action Bar (Mobil)
   ========================================================= */
.fab-row {
  display: none; /* mobil-only; Desktop keine FAB-Leiste */
}
@media (max-width: 900px) {
  .fab-row {
    display: block;
    position: sticky; bottom: 0; z-index: 5;
    background: color-mix(in oklab, var(--card) 92%, transparent);
    border-top: 1px solid var(--border);
    padding: 10px;
    backdrop-filter: blur(6px);
  }
  .fabs { display: flex; gap: 8px; }
  .fab { flex: 1; }
}

/* =========================================================
   Modal (Bearbeiten)
   ========================================================= */
.modal {
  position: fixed; inset: 0;
  display: none; align-items: center; justify-content: center;
  background: rgba(2,6,23,.45);
  z-index: 50;
}
.panel {
  width: min(560px, 94vw);
  background: var(--card); color: var(--ink);
  border: 1px solid var(--border);
  border-radius: 16px;
  box-shadow: var(--shade);
  padding: 16px;
}
.panel h3 { margin: 0 0 10px; }
.form-grid { display: grid; gap: 10px; }
.form-grid input, .form-grid select, .form-grid textarea {
  width: 100%; padding: 10px 12px;
  border: 1px solid var(--border);
  border-radius: 12px; background: var(--card); color: var(--ink);
}
.modal-actions { display: flex; gap: 10px; justify-content: flex-end; margin-top: 10px; }

/* =========================================================
   Kleinkram
   ========================================================= */
a { color: #2563eb; }
a:hover { text-decoration: underline; }

/* Fader für Dark/Light Umschalter */
.fade-x {
  transition: background-color var(--fade-ms) ease, color var(--fade-ms) ease, border-color var(--fade-ms) ease;
}
</style>
</head>
<body>
<div class="app fade-x">

  <!-- ===========================
       HEADER
       =========================== -->
  <div class="h1">
    <span class="icon">📘</span>
    <span>Vokabelübersicht</span>
  </div>
  <div class="subbar"></div>

  <!-- ===========================
       ZÄHLER (zentriert)
       =========================== -->
  <div class="count-row">
    <span class="badge" id="countBadge">📘 0 Vokabeln gefunden</span>
  </div>

  <!-- ===========================
       TOOLBAR (Desktop)
       =========================== -->
  <div class="toolbar">
    <select id="filterCatDesk" class="fade-x">
      <option value="Alle">Alle (bunt gemischt)</option>
      <!-- Kategorien werden per JS ergänzt -->
    </select>

    <input id="searchDesk" type="text" placeholder="Suchen…" class="fade-x">

    <button id="resetDesk" class="btn soft">Reset</button>

    <button id="addDesk" class="btn primary">➕ Neue</button>

    <button id="btnSync" class="btn soft small">🧾 Sync</button>
  </div>

  <!-- Ansichtsschalter -->
  <div style="display:flex;gap:10px;flex-wrap:wrap;margin-bottom:12px;">
    <button id="btnList"   class="btn soft">📋 Liste</button>
    <button id="btnCards"  class="btn soft toggle-active">🧩 Kacheln</button>
    <button id="btnDark"   class="btn soft">🌙 Dark Mode</button>
  </div>

  <!-- ===========================
       LISTEN-ANSICHT (TABLE) – Desktop
       =========================== -->
  <div id="listView" class="table-wrap" style="display:none;">
    <table>
      <thead>
        <tr>
          <th>Englisch</th>
          <th>Deutsch</th>
          <th>Kategorie</th>
          <th class="th-group">Gruppe</th>
          <th class="th-hint">Hinweis</th>
          <th>Aktion</th>
        </tr>
      </thead>
      <tbody id="tblBody">
        <!-- Zeilen via JS -->
      </tbody>
    </table>
  </div>

  <!-- Pagination (List) -->
  <div id="pagination" class="pagination" style="display:none;">
    <button id="pgPrev" class="btn soft small">⬅️ Zurück</button>
    <span class="page-info" id="pgInfo">Seite 1 / 1</span>
    <button id="pgNext" class="btn soft small">Weiter ➡️</button>
  </div>

  <!-- ===========================
       KACHEL-ANSICHT – Desktop
       =========================== -->
  <div id="cardView" class="grid">
    <!-- Karten via JS -->
  </div>

  <!-- ===========================
       MOBILE-FAB (bleibt wie vorher)
       =========================== -->
  <div class="fab-row" id="fabRow">
    <div class="fabs">
      <button class="btn soft fab" id="fabBack">Zurück</button>
      <button class="btn primary fab" id="fabAdjust">Anpassen</button>
      <button class="btn soft fab" id="fabSync">Sync</button>
    </div>
  </div>

  <!-- ===========================
       MODAL – Bearbeiten
       =========================== -->
  <div class="modal" id="modal">
    <div class="panel fade-x">
      <h3 id="modalTitle">Vokabel</h3>
      <div class="form-grid">
        <label>Englisch
          <input id="mEn" type="text">
        </label>
        <label>Deutsch
          <input id="mDe" type="text">
        </label>
        <label>Kategorie
          <select id="mCat"></select>
        </label>
        <div class="confuse-toggle" style="display:flex;align-items:center;justify-content:space-between;gap:12px;padding:10px;border:1px solid var(--border);border-radius:12px;background:var(--chip-bg);color:var(--ink)">
          <span style="font-weight:800;">Verwechslungsgefahr</span>
          <!-- schöner Toggle -->
          <label class="switch" style="position:relative;display:inline-block;width:52px;height:28px;">
            <input type="checkbox" id="mConfuse" style="opacity:0;width:0;height:0;">
            <span class="slider" style="position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background:#c7d2fe;border-radius:26px;transition:.25s;"></span>
            <span class="knob" style="position:absolute;content:'';height:22px;width:22px;left:3px;bottom:3px;background:white;border-radius:50%;transition:.25s;"></span>
          </label>
        </div>
        <label>Gruppe / Variante
          <input id="mGroup" type="text">
        </label>
        <label>Hinweis
          <textarea id="mHint" rows="2"></textarea>
        </label>
      </div>
      <div class="modal-actions">
        <button class="btn soft" id="mCancel">Abbrechen</button>
        <button class="btn primary" id="mSave">Speichern</button>
      </div>
    </div>
  </div>
<!-- =========================================================
     JAVASCRIPT
     ========================================================= -->
<script>
(function(){
  const $ = s => document.querySelector(s);
  const $$ = s => Array.from(document.querySelectorAll(s));
  const isMobile = () => matchMedia("(max-width:900px)").matches;

  /* =========================================================
     VARIABLEN & KONSTANTEN
     ========================================================= */
  const CATEGORY_NAMES = {
    Gelb:"Grundwerkzeuge Metallverarbeitung",
    Pink:"Werkzeugkasten Mechaniker",
    Blau:"Blech-/Kunststoffarbeiten",
    Gruen:"Drehen/Fräsen",
    HellesPink:"Hydraulik/Pneumatik",
    Orange:"Elektrotechnik",
    Dunkelgruen:"Fluggerätemechanik allgemein"
  };
  const COLOR_MAP = {
    Gelb:"#F4D03F", Pink:"#E91E63", Blau:"#1976D2",
    Gruen:"#1E8449", HellesPink:"#F54927",
    Orange:"#E67E22", Dunkelgruen:"#117A65"
  };
  const RAW_URL="https://beeferino.github.io/vokabeltrainer/vokabeln.json";

  let list = [];
  let currentPage = 1;
  const PAGE_SIZE = 15;
  let adjustMode = false;

  /* =========================================================
     DATENLADEN
     ========================================================= */
  async function loadData(){
    try {
      const r = await fetch(RAW_URL,{cache:"no-store"});
      list = await r.json();
    } catch(e) {
      console.warn("Laden aus LocalStorage",e);
      list = JSON.parse(localStorage.getItem("vokabeln")||"[]");
    }
    renderAll();
  }

  /* =========================================================
     FILTERN & PAGINATION
     ========================================================= */
  function currentFilter(){
    const cat = $("#filterCatDesk").value;
    const q = $("#searchDesk").value.toLowerCase();
    return {cat,q};
  }

  function filtered(){
    const {cat,q}=currentFilter();
    return list.filter(v=>{
      const matchCat=cat==="Alle"||v[2]===cat||(cat==="confuse"&&v[6]==1);
      const matchQ=!q||(v[0]&&v[0].toLowerCase().includes(q))||(v[1]&&v[1].toLowerCase().includes(q));
      return matchCat&&matchQ;
    });
  }

  function paginated(){
    const data=filtered();
    const start=(currentPage-1)*PAGE_SIZE;
    return data.slice(start,start+PAGE_SIZE);
  }

  function totalPages(){return Math.ceil(filtered().length/PAGE_SIZE)||1;}

  function changePage(d){
    const max=totalPages();
    currentPage=Math.min(Math.max(currentPage+d,1),max);
    renderAll();
  }

  /* =========================================================
     RENDERING – LIST
     ========================================================= */
  function renderList(){
    const tbody=$("#tblBody");
    const data=paginated();
    tbody.innerHTML=data.map(v=>{
      const danger=v[6]==1?`<span class="confuse-flag">⚠️</span>`:"";
      const colorDot=`<span class="cat-badge"><span class="cat-dot dot-${v[2]}"></span>${v[2]}</span>`;
      return `<tr>
        <td class="cell-english">${v[0]} ${danger}</td>
        <td>${v[1]}</td>
        <td>${colorDot}</td>
        <td>${v[3]||""}</td>
        <td>${v[4]||""}</td>
        <td><button class="btn small soft editRow" data-id="${v[7]}">✏️ Bearbeiten</button></td>
      </tr>`;
    }).join("");

    $$("#pgPrev").forEach(b=>b.onclick=()=>changePage(-1));
    $$("#pgNext").forEach(b=>b.onclick=()=>changePage(1));
    $("#pgInfo").textContent=`Seite ${currentPage} / ${totalPages()}`;
  }

  /* =========================================================
     RENDERING – KACHELN
     ========================================================= */
  function renderCards(){
    const grid=$("#cardView");
    const data=paginated();
    grid.innerHTML=data.map(v=>{
      const danger=v[6]==1?`<span class="confuse-flag">⚠️</span>`:"";
      const group=v[3]?`<div class="chip">Gruppe: ${v[3]}</div>`:"";
      const hint=v[4]?`<div class="hint">${v[4]}</div>`:"";
      return `<div class="card">
        <h3>${v[0]} ${danger}</h3>
        <div class="sub">${v[1]}</div>
        <div class="row">
          <div class="chip"><span class="cat-dot dot-${v[2]}"></span>${CATEGORY_NAMES[v[2]]}</div>
        </div>
        ${group}
        ${hint}
        <button class="btn soft small edit editCard" data-id="${v[7]}">Bearbeiten</button>
      </div>`;
    }).join("");
  }

  /* =========================================================
     RENDER ALL
     ========================================================= */
  function renderAll(){
    $("#countBadge").textContent=`📘 ${filtered().length} Vokabel${filtered().length!==1?"n":""} gefunden`;
    if(viewMode==="list"){
      $("#listView").style.display="block";
      $("#pagination").style.display="flex";
      $("#cardView").style.display="none";
      renderList();
    } else {
      $("#listView").style.display="none";
      $("#pagination").style.display="none";
      $("#cardView").style.display="grid";
      renderCards();
    }
  }

  /* =========================================================
     MODAL-FUNKTIONALITÄT
     ========================================================= */
  const modal=$("#modal");
  const mEn=$("#mEn"),mDe=$("#mDe"),mCat=$("#mCat"),mGroup=$("#mGroup"),mHint=$("#mHint"),mConfuse=$("#mConfuse");
  let editId=null;

  $("#mCancel").onclick=()=>modal.style.display="none";
  modal.addEventListener("click",e=>{if(e.target===modal)modal.style.display="none";});

  $("#mSave").onclick=()=>{
    const en=mEn.value.trim(),de=mDe.value.trim();
    if(!en||!de){alert("Bitte Englisch & Deutsch ausfüllen.");return;}
    const cat=mCat.value,grp=mGroup.value.trim(),hint=mHint.value.trim(),confuse=mConfuse.checked?1:0;
    if(editId){
      const idx=list.findIndex(x=>x[7]===editId);
      if(idx>-1){list[idx][0]=en;list[idx][1]=de;list[idx][2]=cat;list[idx][3]=grp;list[idx][4]=hint;list[idx][6]=confuse;}
    } else {
      list.push([en,de,cat,grp,hint,new Date().toISOString(),confuse,crypto.randomUUID()]);
    }
    localStorage.setItem("vokabeln",JSON.stringify(list));
    modal.style.display="none";
    renderAll();
  };

  function openEdit(id){
    const v=list.find(x=>x[7]===id);
    if(!v)return;
    editId=id;
    mEn.value=v[0];mDe.value=v[1];mCat.value=v[2];mGroup.value=v[3]||"";mHint.value=v[4]||"";mConfuse.checked=v[6]==1;
    modal.style.display="flex";
  }

  document.addEventListener("click",e=>{
    if(e.target.classList.contains("editRow")||e.target.classList.contains("editCard")){
      openEdit(e.target.dataset.id);
    }
  });

  /* =========================================================
     ANSICHTSSCHALTER & DARKMODE
     ========================================================= */
  let viewMode="card";
  $("#btnList").onclick=()=>{viewMode="list";$("#btnList").classList.add("toggle-active");$("#btnCards").classList.remove("toggle-active");renderAll();};
  $("#btnCards").onclick=()=>{viewMode="card";$("#btnCards").classList.add("toggle-active");$("#btnList").classList.remove("toggle-active");renderAll();};

  const root=document.body;
  $("#btnDark").onclick=()=>{
    root.classList.toggle("dark");
    $("#btnDark").innerHTML=root.classList.contains("dark")?"🌞 Light Mode":"🌙 Dark Mode";
  };

  /* =========================================================
     FILTER & RESET
     ========================================================= */
  $("#resetDesk").onclick=()=>{
    $("#filterCatDesk").value="Alle";
    $("#searchDesk").value="";
    currentPage=1;
    renderAll();
  };
  $("#filterCatDesk").onchange=()=>{currentPage=1;renderAll();};
  $("#searchDesk").oninput=()=>{currentPage=1;renderAll();};

  $("#addDesk").onclick=()=>{
    editId=null;
    mEn.value=mDe.value=mGroup.value=mHint.value="";
    mCat.value="Gelb";mConfuse.checked=false;
    modal.style.display="flex";
  };

  /* =========================================================
     INIT-KATEGORIEN
     ========================================================= */
  function fillCategories(){
    const sel=$("#filterCatDesk"),mSel=$("#mCat");
    Object.keys(CATEGORY_NAMES).forEach(k=>{
      const o=document.createElement("option");
      o.value=k;o.textContent=CATEGORY_NAMES[k];
      sel.appendChild(o.cloneNode(true));
      mSel.appendChild(o);
    });
    const confuse=document.createElement("option");
    confuse.value="confuse";
    confuse.textContent="⚠️ Verwechslungsgefahr-Vokabeln";
    sel.appendChild(confuse);
  }

  fillCategories();
  loadData();
})();
</script>
</div>
</body>
</html>
