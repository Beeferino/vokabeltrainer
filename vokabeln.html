<!DOCTYPE html>
<html lang="de"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ğŸ“˜ VokabelÃ¼bersicht</title>

<style>
body { font-family: sans-serif; background: #f7f9fb; margin: 0; padding: 20px; text-align: center; }
.app { max-width: 1100px; margin: auto; }
h1 { font-size: 1.8rem; margin-bottom: 0.6rem; }
section { background: #fff; border-radius: 12px; padding: 18px; margin: 18px 0; box-shadow: 0 2px 5px rgba(0,0,0,0.08); }
section h2 { margin-top: 0; font-size: 1.3rem; color: #2c3e50; border-bottom: 2px solid #e1e6ef; padding-bottom: 4px; }
table { width: 100%; border-collapse: collapse; margin-top: 15px; }
th, td { padding: 10px; border-bottom: 1px solid #ddd; text-align: left; }
th { background: #eef2f7; cursor: pointer; user-select: none; }
th.sort-asc::after { content: " â†‘"; color: #666; }
th.sort-desc::after { content: " â†“"; color: #666; }
tr:hover { background: #f0f7ff; }
.category-chip { display: inline-block; padding: 5px 10px; border-radius: 10px; color: #fff; }
input, select, button { padding: 8px 10px; font-size: 1rem; border-radius: 6px; border: 1px solid #cfd6e4; margin: 5px; }
button { cursor: pointer; background: #2980b9; color: #fff; border: none; }
button:hover { background: #3498db; }
a.linkbtn { display: inline-block; padding: 10px 16px; border-radius: 8px; background: #74b9ff; color: #000; text-decoration: none; font-weight: 600; }
a.linkbtn:hover { background: #a6d4ff; }
.lexica { display: flex; flex-wrap: wrap; gap: 6px; justify-content: center; margin: 10px 0; }
.lexica button { background: #ecf0f1; color: #333; border: 1px solid #ccc; font-weight: 600; padding: 6px 9px; }
.lexica button.active { background: #2980b9; color: #fff; }
.filter-bar { display: flex; justify-content: center; gap: 14px; flex-wrap: wrap; align-items: center; margin-top: 10px; }
.searchbox { min-width: 260px; }
.pagination { display: flex; justify-content: center; gap: 8px; margin-top: 10px; }
.pagination button { background: #ecf0f1; color: #333; border: 1px solid #ccc; padding: 6px 10px; }
.pagination button.active { background: #2980b9; color: #fff; }
.info-footer { margin-top: 10px; font-size: 0.95rem; color: #555; }
.new-entry { margin-top: 10px; }
.toast { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: #2ecc71; color: #fff; padding: 10px 16px; border-radius: 8px; display: none; z-index: 999; }
.edit-btn { background: #f39c12; }
.save-btn { background: #27ae60; }
.save-btn:hover { background: #2ecc71; }
.colored { transition: background 0.4s ease; }
footer { margin-top: 30px; }
#datasourceStatus { position: fixed; right: 12px; bottom: 10px; font-size: .8rem; opacity: .75; color: #555; pointer-events: none; }
#lastAdded { margin-top: 10px; font-size: 0.95rem; color: #2c3e50; background: #f9fbff; border-radius: 10px; padding: 10px; }
#lastAdded ul { list-style: none; padding: 0; margin: 0; }
#lastAdded li { padding: 4px 0; border-bottom: 1px dashed #ccd6e0; }
#lastAdded li:last-child { border-bottom: none; }
</style>
</head>

<body>
  <div class="app">
    <h1>ğŸ“˜ VokabelÃ¼bersicht</h1>

    <section id="filterSection">
      <h2>ğŸ” Filter & Suche</h2>
      <div id="lexica" class="lexica"></div>
      <div class="filter-bar">
        <label>Kategorie:
          <select id="filterCategory" class="colored"><option value="Alle">Alle (bunt gemischt)</option></select>
        </label>
        <label>Gruppe / Variante:
          <select id="filterGroup"><option value="Alle">Alle</option></select>
        </label>
        <input id="searchInput" class="searchbox" type="text" placeholder="ğŸ” Suchen (EN / DE / Gruppe / Hinweis)">
        <button id="resetFilter">ğŸ”„ Filter zurÃ¼cksetzen</button>
      </div>
    </section>

    <section id="tableSection">
      <h2>ğŸ“‹ Vokabelliste</h2>
      <table id="vocabTable">
        <thead>
          <tr>
            <th style="width:36px;">&nbsp;</th>
            <th data-key="en">Englisch</th>
            <th data-key="de">Deutsch</th>
            <th data-key="cat">Kategorie</th>
            <th data-key="grp">Gruppe / Variante</th>
            <th data-key="hint">Hinweis</th>
            <th style="width:80px;">Aktion</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div id="pagination" class="pagination"></div>
      <div id="infoFooter" class="info-footer"></div>

      <!-- NEU: Anzeige der zuletzt hinzugefÃ¼gten 5 -->
      <div id="lastAdded">
        <strong>ğŸ•“ Zuletzt hinzugefÃ¼gt:</strong>
        <ul id="lastList"></ul>
      </div>
    </section>

    <section id="addSection">
      <h2>â• Neue Vokabel hinzufÃ¼gen</h2>
      <div class="new-entry">
        <input id="newEnglish" type="text" placeholder="Englisch" disabled>
        <input id="newGerman" type="text" placeholder="Deutsch" disabled>
        <select id="newCategory" class="colored" disabled></select>
        <input id="newGroup" type="text" placeholder="Gruppe / Variante" disabled>
        <input id="newHint" type="text" placeholder="Hinweis" disabled>
        <button id="addBtn" disabled>HinzufÃ¼gen</button>
      </div>
      <div style="margin-top:8px;">
        <button id="toggleAdd">âœï¸ Eingabe aktivieren</button>
        <button id="deleteSelected">ğŸ—‘ï¸ AusgewÃ¤hlte lÃ¶schen</button>
      </div>
    </section>

    <section id="fileSection">
      <h2>ğŸ’¾ Datei- & JSON-Verwaltung</h2>
      <div>
        <button id="exportBtn">ğŸ“¤ Exportieren</button>
        <input type="file" id="importFile" accept=".json" style="display:none;">
        <button id="importBtn">ğŸ“¥ Importieren</button>
        <button id="downloadMerged">ğŸ’¾ vokabeln.json herunterladen</button>
      </div>
      <div style="margin-top:22px;">
        <a href="index.html" class="linkbtn">â¬…ï¸ ZurÃ¼ck zum Trainer</a>
      </div>
    </section>
  </div>

  <div id="toast" class="toast">ğŸ’¾ Gespeichert</div>
  <div id="datasourceStatus" aria-live="polite">ğŸ“‚ Datenquelle: wird geprÃ¼ft...</div>

  <script>
  (() => {
    // --- Kategorien & Hilfsfunktionen ---
    const CATEGORY_NAMES={Gelb:"Grundwerkzeuge Metallverarbeitung",Pink:"Werkzeugkasten Mechaniker",Blau:"Blech- / Kunststoffarbeiten",Gruen:"Drehen / FrÃ¤sen",HellesPink:"Hydraulik / Pneumatik",Orange:"Elektrotechnik",Dunkelgruen:"FluggerÃ¤temechanik allgemein",Rot:"Verwechslungsgefahr"};
    const COLOR_MAP={Gelb:"#F4D03F",Pink:"#E91E63",Blau:"#1976D2",Gruen:"#1E8449",HellesPink:"#F54927",Orange:"#E67E22",Dunkelgruen:"#117A65",Rot:"#C0392B"};
    const CATEGORY_EMOJI={Gelb:"ğŸŸ¡",Pink:"ğŸŸ£",Blau:"ğŸ”µ",Gruen:"ğŸŸ¢",HellesPink:"ğŸŸ¥",Orange:"ğŸŸ§",Dunkelgruen:"ğŸŸ©",Rot:"ğŸ”´"};
    const labelForCategory=k=>`${CATEGORY_EMOJI[k]||"â€¢"} ${CATEGORY_NAMES[k]}`;
    const $=s=>document.querySelector(s); const $$=s=>[...document.querySelectorAll(s)];
    const toast=m=>{const t=$("#toast");t.textContent=m;t.style.display="block";setTimeout(()=>t.style.display="none",1500);};

    const normalize=v=>[v[0]||"",v[1]||"",v[2]||"Gelb",v[3]||"",v[4]||"",v[5]||new Date().toISOString()];
    const loadLocal=()=>JSON.parse(localStorage.getItem("vokabeln")||"[]").map(normalize);
    const saveLocal=v=>{localStorage.setItem("vokabeln",JSON.stringify(v));localStorage.setItem("vokabeln_updated",new Date().toISOString());};

    const statusEl=$("#datasourceStatus");
    function keyOf(v){return`${(v[0]||"").toLowerCase().trim()}|${(v[1]||"").toLowerCase().trim()}`;}
    function mergeVocabLists(remote,local){const map=new Map();remote.map(normalize).forEach(v=>map.set(keyOf(v),v));local.map(normalize).forEach(v=>{if(!map.has(keyOf(v)))map.set(keyOf(v),v);});return Array.from(map.values());}
    async function trySyncFromJson(){const urls=["./vokabeln.json","vokabeln.json",window.location.origin+"/vokabeln.json",window.location.origin+"/vokabeltrainer/vokabeln.json"];let remote=null;for(const u of urls){try{const r=await fetch(u,{cache:"no-store"});if(!r.ok)continue;const d=await r.json();if(Array.isArray(d)){remote=d;break;}}catch{}}const local=loadLocal();if(!remote&&local.length===0){saveLocal([["hammer","Hammer","Pink"],["file","Feile","Gelb"],["drill","Bohrer","Pink"]]);statusEl.textContent="âœ¨ Standardliste verwendet";list=loadLocal();afterListChange();return;}if(remote){const merged=mergeVocabLists(remote,local);saveLocal(merged);statusEl.textContent="ğŸ”„ JSON + lokale ErgÃ¤nzungen (gemergt)";list=loadLocal();afterListChange();}else{statusEl.textContent="ğŸ’¾ Lokaler Speicher (Offline)";list=loadLocal();afterListChange();}}
    function downloadBlob(name,json){const blob=new Blob([json],{type:"application/json"});const url=URL.createObjectURL(blob);const a=document.createElement("a");a.href=url;a.download=name;a.click();URL.revokeObjectURL(url);}
    function exportJson(){const data=JSON.stringify(loadLocal(),null,2);downloadBlob("vokabeln.json",data);}
    function createBackup(){const today=new Date().toISOString().slice(0,10);const data=JSON.stringify(loadLocal(),null,2);downloadBlob(`vokabeln_backup_${today}.json`,data);}

    function renderLastAdded(){
      const list=loadLocal();
      const last=list.slice(-5).reverse();
      const ul=$("#lastList"); ul.innerHTML="";
      last.forEach(([en,de,cat])=>{
        const li=document.createElement("li");
        li.innerHTML=`<b>${en}</b> â€“ ${de} <span style="color:${COLOR_MAP[cat]}">(${CATEGORY_NAMES[cat]})</span>`;
        ul.appendChild(li);
      });
    }

    // ... (Rest der Rendering- und Interaktionslogik bleibt unverÃ¤ndert)
    // Du kannst hier deinen vorhandenen JS-Code fÃ¼r renderTable(), editRow(), Filter usw. beibehalten.
    // Nach jedem HinzufÃ¼gen oder Synchronisieren einfach:
    // renderLastAdded();

    (async function init(){
      await trySyncFromJson();
      renderLastAdded();
    })();
  })();
  </script>
</body></html>
