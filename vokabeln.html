<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>üìò Vokabel√ºbersicht ‚Äì Beeferino</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
:root{
  --ink:#0f172a;--muted:#6b7280;--bg:#f7f9fb;--card:#ffffff;
  --blue:#2563eb;--ok:#16a34a;--bad:#ef4444;
  --border:#e5ebf3;--shadow:0 8px 26px rgba(0,0,0,.1)
}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,system-ui,sans-serif;background:linear-gradient(145deg,#eef4ff,#dbeafe);color:var(--ink)}
.app{max-width:1100px;margin:20px auto;padding:16px}
h1{text-align:center;font-weight:800;color:#1e3a8a}

/* Desktop */
.toolbar{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin:10px 0}
.toolbar select,.toolbar input{padding:8px 12px;border:1px solid #ccc;border-radius:8px}
.toolbar .btn{background:var(--blue);color:#fff;border:none;border-radius:8px;padding:8px 14px;font-weight:700;cursor:pointer}
.table-wrap{background:#fff;border-radius:16px;box-shadow:var(--shadow);overflow:hidden}
table{width:100%;border-collapse:collapse}
th,td{padding:10px;border-bottom:1px solid var(--border);text-align:left}
tr:hover{background:#f8fbff}
.category-chip{padding:4px 10px;border-radius:999px;color:#fff;font-weight:700;font-size:.9rem}

/* Mobile */
.mobile-header{display:none;position:sticky;top:0;background:#eef4ff;padding:10px;border-bottom:1px solid #dbe3ff;z-index:10}
.mob-title{display:flex;align-items:center;justify-content:space-between}
.mob-actions{display:flex;gap:10px}
.iconbtn{width:40px;height:40px;border-radius:10px;border:1px solid #ccc;background:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer}
.az{display:flex;overflow-x:auto;gap:6px;padding:10px}
.az button{border:1px solid #ccc;border-radius:999px;padding:6px 10px;background:#fff;font-weight:700;cursor:pointer}
.az button.active{background:var(--blue);color:#fff}
.mob-filters{display:none;gap:8px;padding:10px;background:#f9fbff;border-bottom:1px solid #e5ebf3}
.mob-filters select,.mob-filters input{flex:1;padding:10px;border:1px solid #ccc;border-radius:10px}
.mob-list{display:none;padding:10px}
.card{background:#fff;border:1px solid #e5ebf3;border-radius:14px;padding:12px;margin-bottom:10px;box-shadow:0 4px 10px rgba(0,0,0,.06)}
.card-top{display:flex;justify-content:space-between;align-items:center}
.card-title{font-weight:800}
.card-cat{padding:5px 10px;border-radius:999px;color:#fff;font-weight:700}
.card-sub{color:var(--muted);margin-top:6px}
.card-row{margin-top:8px}
.card-row button{width:100%;padding:10px;border:none;border-radius:10px;font-weight:700;background:var(--blue);color:#fff;cursor:pointer}
.fab-row{display:none;position:sticky;bottom:0;background:rgba(255,255,255,.95);padding:10px}
.fabs{display:flex;gap:8px}
.fab{flex:1;padding:12px;border:none;border-radius:10px;font-weight:800;cursor:pointer;color:#fff}
.fab.gray{background:#e5e7eb;color:#111}
.fab.warn{background:var(--bad)}
.fab.blue{background:var(--blue)}

/* Modal */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.4);display:none;align-items:center;justify-content:center;z-index:50}
.panel{background:#fff;border-radius:14px;padding:18px;width:90%;max-width:500px}
.form-grid{display:grid;gap:10px}
.form-grid input,.form-grid select,.form-grid textarea{width:100%;padding:10px;border:1px solid #ccc;border-radius:10px}
.modal-actions{display:flex;gap:10px;justify-content:flex-end;margin-top:14px}
.btn{border:none;border-radius:10px;padding:10px 14px;font-weight:800;cursor:pointer}
.btn.primary{background:var(--blue);color:#fff}
.btn.ghost{background:#eef4ff;color:#111}

/* Responsiv */
@media (max-width:900px){
  .toolbar,.table-wrap{display:none}
  .mobile-header,.mob-filters,.mob-list,.fab-row{display:block}
}
</style>
</head>
<body>
<div class="app">
  <h1>üìò Vokabel√ºbersicht</h1>

  <!-- Desktop -->
  <div class="toolbar">
    <select id="filterCatDesk"></select>
    <input id="searchDesk" type="text" placeholder="Suchen...">
    <button id="resetDesk" class="btn">Reset</button>
    <button id="addDesk" class="btn">‚ûï Neue</button>
    <button id="delDesk" class="btn warn">üóëÔ∏è L√∂schen</button>
    <button id="syncDesk" class="btn">üì§ In Datenbank eintragen</button>
    <button id="tokenBtn" class="btn">‚öôÔ∏è Token</button>
  </div>

  <div class="table-wrap">
    <table id="tbl">
      <thead>
        <tr>
          <th>&nbsp;</th><th>Englisch</th><th>Deutsch</th><th>Kategorie</th><th>Gruppe</th><th>Hinweis</th><th>Aktion</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- Mobile -->
  <div class="mobile-header">
    <div class="mob-title">
      <h2>Vokabeln</h2>
      <div class="mob-actions">
        <button class="iconbtn" id="btnBack">‚¨ÖÔ∏è</button>
        <button class="iconbtn" id="btnSearch">üîé</button>
        <button class="iconbtn" id="btnFilter">üß™</button>
        <button class="iconbtn" id="btnToken">‚öôÔ∏è</button>
      </div>
    </div>
    <div id="azMobile" class="az"></div>
  </div>

  <div class="mob-filters" id="mobFilters">
    <select id="filterCatMob"><option value="Alle">Alle (bunt gemischt)</option></select>
    <input id="searchMob" type="text" placeholder="Suchen‚Ä¶">
    <button id="resetMob" class="btn">Reset</button>
  </div>

  <div class="mob-list" id="mobList"></div>

  <div class="fab-row">
    <div class="fabs">
      <button class="fab gray" id="fabSelect">Auswahl</button>
      <button class="fab warn" id="fabDelete">L√∂schen</button>
      <button class="fab blue" id="fabAdd">Hinzuf√ºgen</button>
      <button class="fab gray" id="fabSync">In DB</button>
    </div>
  </div>

  <div class="footer" style="text-align:center;margin-top:10px">
    <a href="index.html" style="text-decoration:none;color:#1e3a8a;font-weight:700">‚¨ÖÔ∏è Zur√ºck zum Trainer</a>
  </div>
</div>

<!-- Modal -->
<div class="modal" id="modal">
  <div class="panel">
    <h3 id="modalTitle">Vokabel</h3>
    <div class="form-grid">
      <label>Englisch<input id="mEn" type="text"></label>
      <label>Deutsch<input id="mDe" type="text"></label>
      <label>Kategorie<select id="mCat"></select></label>
      <label>Erstellt<input id="mDate" type="datetime-local" readonly style="background:#f3f4f6;"></label>
      <label>Gruppe<input id="mGroup" type="text"></label>
      <label>Hinweis<textarea id="mHint" rows="2"></textarea></label>
    </div>
    <div class="modal-actions">
      <button class="btn ghost" id="mCancel">Abbrechen</button>
      <button class="btn primary" id="mSave">Speichern</button>
    </div>
  </div>
</div>

<script>
(function(){
  const CATEGORY_NAMES={Gelb:"Grundwerkzeuge Metallverarbeitung",Pink:"Werkzeugkasten Mechaniker",Blau:"Blech- / Kunststoffarbeiten",Gruen:"Drehen / Fr√§sen",HellesPink:"Hydraulik / Pneumatik",Orange:"Elektrotechnik",Dunkelgruen:"Flugger√§temechanik allgemein",Rot:"Verwechslungsgefahr"};
  const COLOR_MAP={Gelb:"#F4D03F",Pink:"#E91E63",Blau:"#1976D2",Gruen:"#1E8449",HellesPink:"#F54927",Orange:"#E67E22",Dunkelgruen:"#117A65",Rot:"#C0392B"};
  const TEXT_ON={Gelb:"#000",Pink:"#fff",Blau:"#fff",Gruen:"#fff",HellesPink:"#fff",Orange:"#fff",Dunkelgruen:"#fff",Rot:"#fff"};

  const RAW_URL="https://beeferino.github.io/vokabeltrainer/vokabeln.json";

  const $=s=>document.querySelector(s);
  const $$=s=>Array.from(document.querySelectorAll(s));

  const tbl=$('#tbl tbody');
  const mobList=$('#mobList');
  const modal=$('#modal');
  const mTitle=$('#modalTitle');
  const mEn=$('#mEn'),mDe=$('#mDe'),mCat=$('#mCat'),mDate=$('#mDate'),mGroup=$('#mGroup'),mHint=$('#mHint');
  const mSave=$('#mSave'),mCancel=$('#mCancel');

  let list=[],editIndex=null;

  function normalize(v){return [v[0]||"",v[1]||"",v[2]||"Gelb",v[3]||"",v[4]||"",v[5]||new Date().toISOString()];}
  function loadLocal(){return JSON.parse(localStorage.getItem('vokabeln')||'[]').map(normalize);}
  function saveLocal(d){localStorage.setItem('vokabeln',JSON.stringify(d));}

  async function loadData(){
    try{
      const res=await fetch(RAW_URL);
      const data=await res.json();
      list=data.map(normalize);
      saveLocal(list);
    }catch{list=loadLocal();}
    renderAll();
  }

  function renderAll(){
    renderDesktop();renderMobile();
  }

  function renderDesktop(){
    tbl.innerHTML=list.map((v,i)=>`
      <tr>
        <td><input type="checkbox" data-i="${i}"></td>
        <td>${v[0]}</td><td>${v[1]}</td>
        <td><span class="category-chip" style="background:${COLOR_MAP[v[2]]};color:${TEXT_ON[v[2]]}">${CATEGORY_NAMES[v[2]]}</span></td>
        <td>${v[3]||''}</td><td>${v[4]||''}</td>
        <td><button data-i="${i}" class="btn">‚úèÔ∏è</button></td>
      </tr>`).join('');
    $$('button[data-i]').forEach(b=>b.onclick=()=>openEdit(+b.dataset.i));
  }

  function renderMobile(){
    mobList.innerHTML=list.map((v,i)=>`
      <div class="card">
        <div class="card-top"><div class="card-title">${v[0]}</div>
        <div class="card-cat" style="background:${COLOR_MAP[v[2]]};color:${TEXT_ON[v[2]]}">${CATEGORY_NAMES[v[2]]}</div></div>
        <div class="card-sub">DE: ${v[1]}</div>
        <div class="card-row"><button data-i="${i}" class="mobEdit">Bearbeiten</button></div>
      </div>`).join('');
    $$('.mobEdit').forEach(b=>b.onclick=()=>openEdit(+b.dataset.i));
  }

  function openEdit(i=null){
    editIndex=i;
    if(i==null){
      mTitle.textContent="Neue Vokabel";
      mEn.value=mDe.value=mGroup.value=mHint.value="";
      mCat.value="Gelb";
      mDate.value=new Date().toISOString().slice(0,16);
    }else{
      const v=list[i];
      mTitle.textContent="Vokabel bearbeiten";
      mEn.value=v[0];mDe.value=v[1];mCat.value=v[2];mGroup.value=v[3];mHint.value=v[4];
      mDate.value=v[5].slice(0,16);
    }
    modal.style.display='flex';
  }

  mCancel.onclick=()=>modal.style.display='none';
  mSave.onclick=()=>{
    const en=mEn.value.trim(),de=mDe.value.trim(),cat=mCat.value,grp=mGroup.value.trim(),hint=mHint.value.trim();
    if(!en||!de)return alert("Bitte Englisch & Deutsch ausf√ºllen");
    const created=mDate.value?new Date(mDate.value).toISOString():new Date().toISOString();
    if(editIndex==null)list.push([en,de,cat,grp,hint,created]);
    else list[editIndex]=[en,de,cat,grp,hint,created];
    saveLocal(list);
    renderAll();
    modal.style.display='none';
  }

  modal.addEventListener('click',e=>{if(e.target===modal)modal.style.display='none';});

  Object.keys(CATEGORY_NAMES).forEach(k=>{
    const o=document.createElement('option');o.value=k;o.textContent=CATEGORY_NAMES[k];mCat.appendChild(o);
  });

  loadData();
})();
</script>
</body>
</html>
