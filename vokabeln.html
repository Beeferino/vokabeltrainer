<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>üìò Vokabel√ºbersicht ‚Äì Beeferino</title>
<style>
:root{
  --blue:#2563eb;--light:#f8fafc;--dark:#1e293b;
  --accent:#3b82f6;--accent2:#1d4ed8;
  --ok:#22c55e;--bad:#ef4444;--muted:#9ca3af;
}
body{
  margin:0;font-family:Inter,system-ui,sans-serif;
  background:linear-gradient(135deg,#e0e7ff,#f8fafc);
  color:var(--dark);
}
.app{
  max-width:1000px;margin:32px auto;padding:24px;
  background:rgba(255,255,255,.9);border-radius:22px;
  box-shadow:0 10px 25px rgba(0,0,0,.1);
  backdrop-filter:blur(8px);
}
h1{text-align:center;margin:0;font-size:2rem;color:var(--accent)}
hr{margin:20px 0;border:none;border-top:2px solid #e5e7eb}
.section{margin-top:20px}
.flex{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
input,select,button{
  padding:10px 14px;font-size:1rem;border-radius:12px;
  border:1px solid #d1d5db;
}
button{
  background:var(--accent);color:#fff;cursor:pointer;
  font-weight:700;transition:.2s;
}
button:hover{background:var(--accent2)}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{padding:10px;text-align:left;border-bottom:1px solid #e5e7eb}
th{background:#f1f5f9;cursor:pointer}
tbody tr:hover{background:#f9fafb}
.pagination{text-align:center;margin-top:10px}
.footer{
  text-align:center;margin-top:25px;font-size:.9rem;color:#64748b
}
.footer button{
  background:#e0e7ff;color:var(--dark);
  border:1px solid #cbd5e1;
}
.footer button:hover{background:#c7d2fe}
.toast{
  position:fixed;bottom:25px;right:25px;
  background:var(--ok);color:#fff;
  padding:12px 18px;border-radius:12px;
  opacity:0;transition:opacity .4s;
}
.toast.show{opacity:1}
#modal{
  display:none;position:fixed;top:0;left:0;width:100%;height:100%;
  background:rgba(0,0,0,.4);backdrop-filter:blur(6px);
  justify-content:center;align-items:center;z-index:999;
}
#modalContent{
  background:#fff;padding:22px;border-radius:18px;
  width:90%;max-width:400px;box-shadow:0 8px 24px rgba(0,0,0,.2);
}
#modalContent h3{text-align:center;margin-top:0;color:var(--accent)}
#modalContent input,#modalContent select{
  width:100%;margin-top:8px;margin-bottom:8px;
}
#modalContent .flex{justify-content:space-between}
#newVocabBtn{
  position:fixed;bottom:28px;left:50%;
  transform:translateX(-50%);
  background:var(--ok);padding:14px 28px;
  border-radius:30px;font-size:1.1rem;
  animation:pulse 2s infinite;
}
@keyframes pulse{
  0%{box-shadow:0 0 0 0 rgba(34,197,94,.4)}
  70%{box-shadow:0 0 0 15px rgba(34,197,94,0)}
  100%{box-shadow:0 0 0 0 rgba(34,197,94,0)}
}
details.recent{
  margin-top:18px;padding:18px;
  border-radius:20px;background:#f9fafb;
  box-shadow:0 4px 12px rgba(0,0,0,.08);
}
details.recent summary{
  font-weight:800;color:var(--accent);
  text-align:center;cursor:pointer;
}
#recentList{
  display:flex;flex-wrap:wrap;justify-content:center;
  gap:12px;margin-top:10px;
}
.recent-item{
  min-width:150px;padding:10px 16px;border-radius:14px;
  font-weight:700;box-shadow:0 3px 8px rgba(0,0,0,.1);
  text-align:center;
}
#lexikon{
  display:flex;flex-wrap:wrap;gap:6px;margin-top:10px;
  justify-content:center;
}
#lexikon button{
  background:#e2e8f0;color:#1e293b;border:none;
  padding:6px 10px;font-weight:600;border-radius:8px;
}
#lexikon button.active{background:var(--accent);color:#fff}
#lexikon button:hover{background:#cbd5e1}
</style>
</head>
<body>
<div class="app">
  <h1>üìò Vokabel√ºbersicht</h1>
  <hr>
  
  <div class="section flex">
    <label>Sortierung:
      <select id="sortABC">
        <option value="en">A‚ÄìZ Englisch</option>
        <option value="de">A‚ÄìZ Deutsch</option>
        <option value="cat">Nach Kategorie</option>
      </select>
    </label>
    <label>Kategorie:
      <select id="filterCat">
        <option value="Alle">Alle (bunt gemischt)</option>
      </select>
    </label>
    <input id="searchInput" type="text" placeholder="üîé Suchen ‚Ä¶">
    <button id="resetFilter">üîÑ Reset</button>
  </div>

  <div id="lexikon" class="section"></div>

  <div class="section">
    <table id="vokabelTable">
      <thead><tr>
        <th>Englisch</th><th>Deutsch</th><th>Kategorie</th><th>Aktion</th>
      </tr></thead>
      <tbody></tbody>
    </table>
  </div>

  <details class="recent"><summary>üßæ Zuletzt hinzugef√ºgt</summary>
    <div id="recentList"></div>
  </details>

  <div class="footer">
    <button onclick="window.location.href='index.html'">‚¨ÖÔ∏è Zur√ºck zum Trainer</button>
    <p>¬© 2025 Beeferino</p>
  </div>
</div>

<button id="newVocabBtn">‚ûï Neue Vokabel</button>

<div id="modal">
  <div id="modalContent">
    <h3 id="modalTitle">‚ûï Neue Vokabel</h3>
    <input id="newEn" type="text" placeholder="Englisch">
    <input id="newDe" type="text" placeholder="Deutsch">
    <select id="newCat"></select>
    <input id="newGroup" type="text" placeholder="Gruppe / Variante">
    <input id="newHint" type="text" placeholder="Hinweis">
    <div class="flex">
      <button id="saveVocab">Speichern</button>
      <button id="deleteVocab" style="background:var(--bad)">L√∂schen</button>
      <button id="cancelModal">Abbrechen</button>
    </div>
  </div>
</div>

<div id="toast" class="toast">Gespeichert</div>

<script>
(async()=>{
const el=id=>document.getElementById(id);
const tBody=el("vokabelTable").querySelector("tbody");
const filterCat=el("filterCat"),searchInput=el("searchInput");
const resetFilter=el("resetFilter"),toast=el("toast");
const modal=el("modal"),saveVocab=el("saveVocab"),cancelModal=el("cancelModal"),deleteVocab=el("deleteVocab");
const newBtn=el("newVocabBtn"),recentList=el("recentList");
const sortSel=el("sortABC"),modalTitle=el("modalTitle");
const newEn=el("newEn"),newDe=el("newDe"),newCat=el("newCat"),newGroup=el("newGroup"),newHint=el("newHint");
const lexikon=el("lexikon");
let data=[];let editIndex=null;let syncTimer;

const GITHUB_REPO="beeferino/vokabeltrainer";const FILE_PATH="vokabeln.json";

const CATS={
  Gelb:["Grundwerkzeuge Metallverarbeitung","#F4D03F","#000"],
  Pink:["Werkzeugkasten Mechaniker","#E91E63","#fff"],
  Blau:["Blech- / Kunststoffarbeiten","#1976D2","#fff"],
  Gruen:["Drehen / Fr√§sen","#1E8449","#fff"],
  HellesPink:["Hydraulik / Pneumatik","#F54927","#fff"],
  Orange:["Elektrotechnik","#E67E22","#fff"],
  Dunkelgruen:["Flugger√§temechanik allgemein","#117A65","#fff"],
  Rot:["Verwechslungsgefahr","#C0392B","#fff"]
};

for(const k in CATS){
  const o=document.createElement("option");
  o.value=k;o.textContent=CATS[k][0];
  o.style.background=CATS[k][1];o.style.color=CATS[k][2];
  newCat.appendChild(o);filterCat.appendChild(o.cloneNode(true));
}

const LETTERS="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
lexikon.innerHTML='<button class="active" data-letter="Alle">Alle</button>'+
  LETTERS.map(l=>`<button data-letter="${l}">${l}</button>`).join("");
lexikon.querySelectorAll("button").forEach(btn=>{
  btn.onclick=()=>{
    lexikon.querySelectorAll("button").forEach(b=>b.classList.remove("active"));
    btn.classList.add("active");
    render();
  };
});

async function loadData(){
  try{
    const r=await fetch(`https://beeferino.github.io/vokabeltrainer/${FILE_PATH}`,{cache:"no-store"});
    data=await r.json();
  }catch{data=JSON.parse(localStorage.getItem("vokabeln")||"[]");}
  localStorage.setItem("vokabeln",JSON.stringify(data));
  render();
}

function render(){
  const search=searchInput.value.toLowerCase();
  const cat=filterCat.value;
  const letter=lexikon.querySelector("button.active").dataset.letter;
  let filtered=data.filter(v=>
    (cat==="Alle"||v[2]===cat)&&
    (v[0].toLowerCase().includes(search)||v[1].toLowerCase().includes(search))
  );
  if(letter!=="Alle") filtered=filtered.filter(v=>v[0][0]?.toUpperCase()===letter);
  if(sortSel.value==="en")filtered.sort((a,b)=>a[0].localeCompare(b[0]));
  if(sortSel.value==="de")filtered.sort((a,b)=>a[1].localeCompare(b[1]));
  if(sortSel.value==="cat")filtered.sort((a,b)=>a[2].localeCompare(b[2]));
  tBody.innerHTML=filtered.map((v,i)=>{
    const c=CATS[v[2]]||["","#eee","#000"];
    return `<tr>
      <td>${v[0]}</td><td>${v[1]}</td>
      <td style="background:${c[1]};color:${c[2]};font-weight:700">${c[0]}</td>
      <td>
        <button onclick="edit(${i})">‚úèÔ∏è</button>
        <button onclick="del(${i})">üóëÔ∏è</button>
      </td>
    </tr>`;
  }).join("");
  const last=data.slice(-5).reverse();
  recentList.innerHTML=last.map(v=>{
    const c=CATS[v[2]]||["","#ccc","#000"];
    return `<div class='recent-item' style='background:${c[1]};color:${c[2]}'>
      <b>${v[0]}</b> ‚Äì ${v[1]}<br><small>${c[0]}</small>
    </div>`;
  }).join("");
}

window.del=i=>{data.splice(i,1);storeAndSync();render();};

window.edit=i=>{
  editIndex=i;
  const v=data[i];
  newEn.value=v[0];newDe.value=v[1];newCat.value=v[2];
  newGroup.value=v[3]||"";newHint.value=v[4]||"";
  modalTitle.textContent="‚úèÔ∏è Vokabel bearbeiten";
  modal.style.display="flex";
};

function storeAndSync(){
  localStorage.setItem("vokabeln",JSON.stringify(data));
  toast.classList.add("show");
  setTimeout(()=>toast.classList.remove("show"),1500);
  if(syncTimer)clearTimeout(syncTimer);
  syncTimer=setTimeout(pushToGitHub,20000);
}

async function pushToGitHub(){
  const token=localStorage.getItem("GH_TOKEN");
  if(!token)return;
  const content=btoa(unescape(encodeURIComponent(JSON.stringify(data,null,2))));
  const url=`https://api.github.com/repos/${GITHUB_REPO}/contents/${FILE_PATH}`;
  const current=await fetch(url,{headers:{Authorization:`token ${token}`}}).then(r=>r.json());
  await fetch(url,{
    method:"PUT",
    headers:{
      Authorization:`token ${token}`,
      "Content-Type":"application/json"
    },
    body:JSON.stringify({
      message:"Automatische Synchronisierung",
      content:content,
      sha:current.sha
    })
  });
}

searchInput.oninput=render;filterCat.onchange=render;
resetFilter.onclick=()=>{filterCat.value="Alle";searchInput.value="";lexikon.querySelectorAll("button").forEach(b=>b.classList.remove("active"));lexikon.querySelector("button[data-letter='Alle']").classList.add("active");render();};
sortSel.onchange=render;

newBtn.onclick=()=>{editIndex=null;modalTitle.textContent="‚ûï Neue Vokabel";modal.style.display="flex";}
cancelModal.onclick=()=>modal.style.display="none";

saveVocab.onclick=()=>{
  if(!newEn.value||!newDe.value||!newCat.value)return;
  const entry=[newEn.value.trim(),newDe.value.trim(),newCat.value,newGroup.value,newHint.value];
  if(editIndex!==null) data[editIndex]=entry;
  else data.push(entry);
  modal.style.display="none";
  newEn.value=newDe.value=newGroup.value=newHint.value="";
  storeAndSync();render();
};
deleteVocab.onclick=()=>{
  if(editIndex!==null){data.splice(editIndex,1);storeAndSync();render();}
  modal.style.display="none";
};
  // GitHub Token setzen
const setTokenBtn = document.getElementById("setTokenBtn");
setTokenBtn.onclick = async () => {
  const token = prompt("Bitte deinen pers√∂nlichen GitHub Token eingeben (beginnt mit ghp_‚Ä¶):");
  if (!token) return alert("‚ùå Kein Token eingegeben.");
  localStorage.setItem("GH_TOKEN", token.trim());
  alert("‚úÖ GitHub Token gespeichert!\nEr bleibt im Browser erhalten, bis du den Cache l√∂schst.");
};

loadData();
})();

  <div class="footer">
  <button onclick="window.location.href='index.html'">‚¨ÖÔ∏è Zur√ºck zum Trainer</button>
  <button id="setTokenBtn">üîë GitHub-Token setzen</button>
  <p>¬© 2025 Beeferino</p>
</div>

</script>
</body>
</html>
