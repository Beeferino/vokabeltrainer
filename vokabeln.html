<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>üìò Vokabel√ºbersicht ‚Äì Beeferino</title>
<style>
:root{
  --blue:#2563eb;--ok:#22c55e;--bad:#ef4444;--muted:#6b7280;
  --bg:#eef4ff;--ink:#0f172a;
}
body{margin:0;font-family:Inter,system-ui,sans-serif;background:var(--bg);color:var(--ink);}
.app{max-width:1080px;margin:20px auto;padding:16px;}
h1{margin:0;font-size:1.6rem;color:#1e3a8a;text-align:center;}

/* Buttonbar */
.topbar{display:flex;justify-content:center;flex-wrap:wrap;gap:10px;margin-bottom:10px;}
.topbar button,.topbar a{background:#fff;border:1px solid #dbe3ff;border-radius:12px;padding:10px 14px;font-weight:700;cursor:pointer;text-decoration:none;color:#1f2937;box-shadow:0 2px 6px rgba(0,0,0,.05);}
.topbar button:hover,.topbar a:hover{background:#dce7ff;}

/* Filterpanel */
.panel{background:#fff;border-radius:14px;padding:12px 14px;margin-top:12px;box-shadow:0 4px 14px rgba(0,0,0,.05);}
.controls{display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:center;}
.controls input,.controls select{padding:8px 10px;border-radius:8px;border:1px solid #cfd6e4;font-size:1rem;}
.controls button{padding:8px 10px;border-radius:8px;border:none;background:var(--blue);color:#fff;font-weight:700;cursor:pointer;}
.controls button:hover{background:#1d4ed8;}
.abc{display:flex;flex-wrap:wrap;gap:6px;justify-content:center;margin:6px 0 8px;}
.abc button{background:#ecf0f9;border:1px solid #d9e2f2;color:#1f2937;padding:5px 9px;border-radius:999px;font-weight:700;cursor:pointer;}
.abc button.active{background:var(--blue);color:#fff;border-color:var(--blue);}

/* DESKTOP TABLE */
.table-wrap{overflow:auto;border-radius:12px;}
table{width:100%;border-collapse:collapse;}
th,td{padding:10px;border-bottom:1px solid #e5e7eb;text-align:left;}
th{background:#eef4ff;}
.cat-chip{padding:4px 10px;border-radius:999px;font-weight:700;color:#fff;}
.rowlink{color:var(--blue);font-weight:700;cursor:pointer;}
.rowlink:hover{text-decoration:underline;}

/* MOBILE CARD VIEW */
@media (max-width:700px){
  table{display:none;}
  .cardlist{display:flex;flex-direction:column;gap:10px;margin-top:10px;}
  .vocab-card{background:#fff;border-radius:14px;padding:14px;box-shadow:0 4px 14px rgba(0,0,0,.08);position:relative;cursor:pointer;}
  .vocab-card h3{margin:0 0 4px 0;font-size:1.2rem;}
  .vocab-card p{margin:0;font-size:1rem;}
  .vocab-card .cat-chip{position:absolute;top:8px;right:8px;font-size:.8rem;padding:3px 8px;}
}

/* MODAL */
.modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.45);z-index:1000;}
.sheet{background:#fff;border-radius:16px;padding:18px;width:92%;max-width:520px;box-shadow:0 10px 30px rgba(0,0,0,.25);}
.sheet h3{margin:0 0 8px 0;}
.form-row{display:flex;gap:8px;flex-wrap:wrap;}
.form-row .w50{flex:1 1 240px;}
.form-row .w100{flex:1 1 100%;}
.sheet input,.sheet select,.sheet textarea{width:100%;padding:10px 12px;border:1px solid #d1d5db;border-radius:10px;font-size:1rem;}
.sheet .rowend{display:flex;justify-content:space-between;gap:10px;margin-top:12px;}
.sheet .rowend .danger{background:#ef4444;color:#fff;border:none;border-radius:10px;padding:10px 14px;font-weight:800;}
.sheet .rowend .primary{background:#2563eb;color:#fff;border:none;border-radius:10px;padding:10px 14px;font-weight:800;}
.sheet .rowend .ghost{border:1px solid #dbe3ff;background:#eaf0ff;color:#1f2937;border-radius:10px;padding:10px 14px;font-weight:800;}
</style>
</head>
<body>
<div class="app">
  <h1>üìò Vokabel√ºbersicht</h1>

  <!-- TOPBAR -->
  <div class="topbar">
    <a href="index.html">üè† Trainer</a>
    <button id="btnSync">üîÑ Von GitHub</button>
    <button id="btnPush">‚¨ÜÔ∏è In Datenbank</button>
    <button id="add">‚ûï Neue</button>
  </div>

  <!-- FILTER -->
  <div class="panel">
    <div class="controls">
      <select id="filterCat"><option value="Alle">Alle</option></select>
      <input id="search" placeholder="Suchen‚Ä¶" />
      <button id="reset">Reset</button>
    </div>
    <div class="abc" id="abc"></div>
  </div>

  <!-- TABLE + CARDS -->
  <div class="panel table-wrap">
    <table id="vtable"><thead><tr><th>EN</th><th>DE</th><th>Kategorie</th></tr></thead><tbody></tbody></table>
    <div id="cardlist" class="cardlist"></div>
  </div>

  <div style="text-align:center;color:#6b7280;margin-top:10px;">¬© 2025 Beeferino</div>
</div>

<!-- MODAL -->
<div class="modal" id="modalEdit">
  <div class="sheet">
    <h3>Vokabel bearbeiten</h3>
    <div class="form-row">
      <div class="w50"><label>Englisch<input id="eEn"></label></div>
      <div class="w50"><label>Deutsch<input id="eDe"></label></div>
      <div class="w50"><label>Kategorie<select id="eCat"></select></label></div>
      <div class="w50"><label>Gruppe<input id="eGrp"></label></div>
      <div class="w100"><label>Hinweis<textarea id="eHint" rows="2"></textarea></label></div>
    </div>
    <div class="rowend">
      <button id="del" class="danger">L√∂schen</button>
      <div>
        <button id="close" class="ghost">Abbrechen</button>
        <button id="save" class="primary">Speichern</button>
      </div>
    </div>
  </div>
</div>

<script>
(() => {
const CATS={Gelb:"Grundwerkzeuge Metallverarbeitung",Pink:"Werkzeugkasten Mechaniker",Blau:"Blech- / Kunststoffarbeiten",Gruen:"Drehen / Fr√§sen",HellesPink:"Hydraulik / Pneumatik",Orange:"Elektrotechnik",Dunkelgruen:"Flugger√§temechanik allgemein",Rot:"Verwechslungsgefahr"};
const COLORS={Gelb:"#F4D03F",Pink:"#E91E63",Blau:"#1976D2",Gruen:"#1E8449",HellesPink:"#F54927",Orange:"#E67E22",Dunkelgruen:"#117A65",Rot:"#C0392B"};
const TEXT=c=>["Gelb"].includes(c)?"#000":"#fff";
const $=s=>document.querySelector(s);
let list=[];let letter="Alle";
const table=$("#vtable tbody"),cards=$("#cardlist"),filter=$("#filterCat"),abc=$("#abc");
const modal=$("#modalEdit"),eEn=$("#eEn"),eDe=$("#eDe"),eCat=$("#eCat"),eGrp=$("#eGrp"),eHint=$("#eHint"),btnSave=$("#save"),btnDel=$("#del"),btnClose=$("#close");
let editIndex=-1;

function fillCat(sel){sel.innerHTML="";for(const k in CATS){const o=document.createElement("option");o.value=k;o.textContent=CATS[k];sel.appendChild(o);}}
fillCat(filter);fillCat(eCat);

function renderABC(){abc.innerHTML="";["Alle",..."ABCDEFGHIJKLMNOPQRSTUVWXYZ"].forEach(L=>{const b=document.createElement("button");b.textContent=L;if(L===letter)b.classList.add("active");b.onclick=()=>{letter=L;render();};abc.appendChild(b);});}

function getFiltered(){
  const term=$("#search").value.toLowerCase();
  return list.filter(([en,de,cat])=>{
    if(letter!=="Alle"&&!en.toUpperCase().startsWith(letter))return false;
    if(filter.value!=="Alle"&&cat!==filter.value)return false;
    if(term&&!(`${en} ${de}`.toLowerCase().includes(term)))return false;
    return true;
  });
}

function render(){
  const arr=getFiltered();
  table.innerHTML=arr.map(v=>`<tr><td class="rowlink">${v[0]}</td><td>${v[1]}</td><td><span class="cat-chip" style="background:${COLORS[v[2]]};color:${TEXT(v[2])}">${CATS[v[2]]}</span></td></tr>`).join("");
  cards.innerHTML=arr.map((v,i)=>`
    <div class="vocab-card" data-i="${i}">
      <h3>${v[0]}</h3><p>${v[1]}</p>
      <div class="cat-chip" style="background:${COLORS[v[2]]};color:${TEXT(v[2])}">${CATS[v[2]]}</div>
    </div>`).join("");
  $$("#vtable .rowlink").forEach((td,i)=>td.onclick=()=>openEdit(arr.indexOf(list[i])));
  $$("#cardlist .vocab-card").forEach(c=>c.onclick=()=>openEdit(arr.indexOf(list.find(v=>v[0]===c.querySelector("h3").textContent))));
}

function openEdit(i){editIndex=i;eEn.value=list[i]?.[0]||"";eDe.value=list[i]?.[1]||"";eCat.value=list[i]?.[2]||"Gelb";eGrp.value=list[i]?.[3]||"";eHint.value=list[i]?.[4]||"";modal.style.display="flex";}
btnClose.onclick=()=>modal.style.display="none";
btnSave.onclick=()=>{const v=[eEn.value.trim(),eDe.value.trim(),eCat.value,eGrp.value,eHint.value,new Date().toISOString()];if(!v[0]||!v[1])return alert("Fehlende Eingabe.");if(editIndex<0)list.push(v);else list[editIndex]=v;save();modal.style.display="none";render();}
btnDel.onclick=()=>{if(editIndex<0)return;list.splice(editIndex,1);save();modal.style.display="none";render();}

$("#add").onclick=()=>{editIndex=-1;openEdit(-1);}
$("#search").oninput=()=>render();
$("#reset").onclick=()=>{$("#search").value="";filter.value="Alle";letter="Alle";renderABC();render();}
filter.onchange=()=>render();

function save(){localStorage.setItem("vokabeln",JSON.stringify(list));}
function load(){list=JSON.parse(localStorage.getItem("vokabeln")||"[]");}

async function syncFromGitHub(){
  try{
    const r=await fetch("https://raw.githubusercontent.com/beeferino/vokabeltrainer/main/vokabeln.json?cacheBust="+Date.now());
    const j=await r.json();list=j;save();render();alert("Von GitHub geladen.");
  }catch(e){alert("Fehler beim Laden: "+e);}
}
async function pushToGitHub(){
  try{
    const token=localStorage.getItem("gh_token");
    if(!token){alert("Token fehlt");return;}
    const api="https://api.github.com/repos/beeferino/vokabeltrainer/contents/vokabeln.json";
    const r1=await fetch(api);const {sha}=await r1.json();
    const content=btoa(unescape(encodeURIComponent(JSON.stringify(list,null,2))));
    const r2=await fetch(api,{method:"PUT",headers:{"Authorization":"Bearer "+token,"Content-Type":"application/json"},body:JSON.stringify({message:"Update via UI",content,sha})});
    if(!r2.ok)throw new Error(await r2.text());
    alert("‚úÖ In Datenbank eingetragen");
  }catch(e){alert("Fehler beim Push: "+e.message);}
}

$("#btnSync").onclick=syncFromGitHub;
$("#btnPush").onclick=pushToGitHub;

renderABC();load();render();
})();
</script>
</body>
</html>
