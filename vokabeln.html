<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>üìò Vokabel√ºbersicht ‚Äì Beeferino</title>

<!-- Inter-Font -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

<style>
/* ========= Farb- und Designvariablen ========= */
:root{
  --ink:#0f172a;             /* Prim√§rschriftfarbe (Light) */
  --muted:#64748b;
  --bg:#f8fafc;
  --card:#ffffff;
  --border:#e2e8f0;
  --shadow:0 8px 26px rgba(0,0,0,.08);
  --blue:#2563eb;
  --bad:#ef4444;
  --ok:#16a34a;
}

/* ========= Grundlayout ========= */
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:Inter,system-ui,sans-serif;
  background:var(--bg);
  color:var(--ink);
  min-height:100vh;
  transition:background-color .4s,color .4s;
}
h1{text-align:center;font-weight:800;margin:10px 0 4px;color:#1e3a8a}
.hr{width:160px;height:4px;background:var(--blue);border-radius:4px;margin:8px auto 16px}

/* ========= Toolbar oben ========= */
.toolbar{
  display:flex;flex-wrap:wrap;gap:8px;justify-content:center;margin:10px auto 16px;
  max-width:1100px;
}
.toolbar select,
.toolbar input{
  padding:8px 12px;
  border:1px solid var(--border);
  border-radius:10px;
  font-size:.95rem;
}
.toolbar button{
  background:var(--blue);
  color:#fff;
  border:none;
  border-radius:10px;
  padding:8px 14px;
  font-weight:700;
  cursor:pointer;
}
.toolbar button.warn{background:var(--bad)}
.toolbar button.outline{
  background:transparent;
  color:var(--ink);
  border:1px solid var(--border);
}
.toolbar button.small{padding:6px 10px;font-size:.9rem}
.toolbar button.active{box-shadow:0 0 0 2px var(--blue) inset}

/* ========= Tabellenbereich ========= */
.table-wrap{
  background:var(--card);
  border-radius:16px;
  box-shadow:var(--shadow);
  overflow:hidden;
  margin:auto;
  max-width:1100px;
}
table{width:100%;border-collapse:collapse}
th,td{padding:10px 12px;text-align:left;border-bottom:1px solid var(--border)}
th{font-weight:700;background:#f1f5f9}
tr:hover{background:#f8fafc}
.category-chip{
  padding:4px 10px;
  border-radius:999px;
  font-weight:600;
  font-size:.9rem;
  color:#fff;
}
.red-flag{color:var(--bad);margin-left:4px}

/* ========= Grid (Kachelansicht) ========= */
.grid{
  display:none;
  grid-template-columns:repeat(auto-fill,minmax(320px,1fr));
  gap:16px;
  padding:10px;
  max-width:1100px;
  margin:auto;
}
.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:14px;
  padding:14px;
  box-shadow:var(--shadow);
  transition:.25s;
  cursor:pointer;
}
.card:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(0,0,0,.1);}
.card.selected{outline:3px solid var(--blue);}
.card-title{font-weight:800;font-size:1.05rem;margin-bottom:6px;}
.card-sub{color:var(--muted);margin-bottom:8px;}
.card-cat{
  display:inline-block;
  padding:4px 10px;
  border-radius:999px;
  font-weight:700;
  font-size:.9rem;
}
.confuse{color:#ef4444;font-weight:700;margin-left:6px;}

/* ========= Mobile Footer-Buttons (wird in Teil 4 aktiviert) ========= */
.mobile-bar{
  position:fixed;
  left:0;right:0;bottom:0;
  display:flex;
  justify-content:space-between;
  gap:8px;
  background:rgba(255,255,255,.9);
  padding:10px;
  border-top:1px solid var(--border);
  backdrop-filter:blur(10px);
  z-index:40;
}
.mobile-bar button{
  flex:1;
  border:none;
  border-radius:12px;
  font-weight:700;
  padding:12px;
  cursor:pointer;
  transition:.25s;
}
.mobile-bar button.primary{background:var(--blue);color:#fff}
.mobile-bar button.outline{background:#fff;border:1px solid var(--border)}
.mobile-bar button.danger{background:var(--bad);color:#fff}

/* ========= Dark Mode ========= */
body.dark{
  --bg:#0f172a;
  --card:#1e293b;
  --ink:#f1f5f9;
  --border:#334155;
  --muted:#94a3b8;
  background:linear-gradient(145deg,#1e293b,#0f172a);
  color:var(--ink);
}
body.dark table th{background:#1e293b}
body.dark .table-wrap,
body.dark .card{background:#1e293b;border-color:#334155;}
body.dark .mobile-bar{background:rgba(30,41,59,.9);}
body.dark .toolbar button.outline{border-color:#475569;color:#f1f5f9;}
body.dark .toolbar select,
body.dark .toolbar input{background:#1e293b;color:#f1f5f9;border-color:#475569;}

/* ========= Responsivit√§t ========= */
@media(max-width:900px){
  .toolbar,#tableContainer{display:none}
  .grid{display:grid;grid-template-columns:1fr 1fr;}
}
@media(min-width:901px){
  .mobile-bar{display:none}
}
</style>
</head>

<body>
<div class="app">
  <h1>üìò Vokabel√ºbersicht</h1>
  <div class="hr"></div>

  <!-- ===== Toolbar mit Dark-Mode-Schalter ===== -->
  <div class="toolbar">
    <select id="filterCat">
      <option value="Alle">Alle (bunt gemischt)</option>
    </select>
    <input id="searchInput" type="text" placeholder="Suchen‚Ä¶">
    <button id="btnReset" class="outline">Reset</button>
    <button id="btnList" class="outline active">Liste</button>
    <button id="btnCards" class="outline">Kacheln</button>
    <button id="btnDark" class="outline">üåô Dark Mode</button>
    <button id="btnSync" class="outline small">üì§ Sync</button>
    <button id="btnBack" class="outline small" onclick="location.href='index.html'">‚¨ÖÔ∏è Trainer</button>
  </div>

  <!-- ===== Z√§hler ===== -->
  <div id="countDesk" style="text-align:center;margin:8px 0;font-weight:600;color:#1e3a8a">
    üìò <span id="countNum">0</span> Vokabeln gefunden
  </div>

  <!-- ===== Tabellenansicht ===== -->
  <div class="table-wrap" id="tableContainer">
    <table>
      <thead>
        <tr>
          <th></th>
          <th>Englisch</th>
          <th>Deutsch</th>
          <th>Kategorie</th>
        </tr>
      </thead>
      <tbody id="tblBody"></tbody>
    </table>
  </div>

  <!-- ===== Kachelansicht (wird dynamisch gef√ºllt) ===== -->
  <div class="grid" id="grid"></div>

  <!-- Platzhalter f√ºr Pagination -->
  <div id="pagination"></div>
</div>
<!-- ========= Modal zum Bearbeiten / Neu anlegen ========= -->
<div class="modal" id="modal" style="display:none;align-items:center;justify-content:center;position:fixed;inset:0;background:rgba(0,0,0,.4);z-index:100;">
  <div class="panel" style="background:var(--card);border-radius:16px;padding:20px;width:92%;max-width:520px;box-shadow:var(--shadow);">
    <h3 style="margin-top:0;font-weight:800;color:var(--ink);">Vokabel bearbeiten</h3>
    <div class="form-grid" style="display:grid;gap:12px;">
      <label>Englisch
        <input id="mEn" type="text" style="width:100%;padding:10px;border:1px solid var(--border);border-radius:10px;">
      </label>
      <label>Deutsch
        <input id="mDe" type="text" style="width:100%;padding:10px;border:1px solid var(--border);border-radius:10px;">
      </label>
      <label>Kategorie
        <select id="mCat" style="width:100%;padding:10px;border:1px solid var(--border);border-radius:10px;"></select>
      </label>
      <label>Gruppe / Variante
        <input id="mGroup" type="text" style="width:100%;padding:10px;border:1px solid var(--border);border-radius:10px;">
      </label>
      <label>Hinweis
        <textarea id="mHint" rows="2" style="width:100%;padding:10px;border:1px solid var(--border);border-radius:10px;"></textarea>
      </label>
      <div style="display:flex;align-items:center;justify-content:space-between;">
        <label>Erstellt:
          <input id="mDate" type="date" readonly style="background:#f3f4f6;border:1px solid var(--border);border-radius:10px;padding:8px 10px;">
        </label>
        <!-- sch√∂ner Toggle-Schalter -->
        <div class="confuse-toggle" style="display:flex;align-items:center;gap:8px;">
          <span>Verwechslungsgefahr</span>
          <label class="switch" style="position:relative;display:inline-block;width:48px;height:26px;">
            <input type="checkbox" id="mConfuse" style="opacity:0;width:0;height:0;">
            <span class="slider" style="position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background:#ccc;transition:.3s;border-radius:34px;">
              <span style="position:absolute;content:'';height:20px;width:20px;left:3px;bottom:3px;background:white;transition:.3s;border-radius:50%;"></span>
            </span>
          </label>
        </div>
      </div>
    </div>
    <div class="modal-actions" style="display:flex;gap:16px;justify-content:flex-end;margin-top:18px;">
      <button id="btnCancel" class="outline">Abbrechen</button>
      <button id="btnSave" class="primary">Speichern</button>
    </div>
  </div>
</div>

<!-- ========= Script: Datenstruktur, Kategorien, LocalStorage ========= -->
<script>
(function(){

/* ===== Kategorien definieren (Name, Hintergrund, Schriftfarbe) ===== */
const CATS={
  Gelb:["Grundwerkzeuge Metallverarbeitung","#F4D03F","#000"],
  Pink:["Werkzeugkasten Mechaniker","#E91E63","#fff"],
  Blau:["Blech- / Kunststoffarbeiten","#1976D2","#fff"],
  Gruen:["Drehen / Fr√§sen","#1E8449","#fff"],
  HellesPink:["Hydraulik / Pneumatik","#F54927","#fff"],
  Orange:["Elektrotechnik","#E67E22","#fff"],
  Dunkelgruen:["Flugger√§temechanik allgemein","#117A65","#fff"]
};

/* ===== DOM-Referenzen ===== */
const modal=document.getElementById("modal");
const mEn=document.getElementById("mEn");
const mDe=document.getElementById("mDe");
const mCat=document.getElementById("mCat");
const mGroup=document.getElementById("mGroup");
const mHint=document.getElementById("mHint");
const mDate=document.getElementById("mDate");
const mConfuse=document.getElementById("mConfuse");
const btnSave=document.getElementById("btnSave");
const btnCancel=document.getElementById("btnCancel");
const tblBody=document.getElementById("tblBody");
const grid=document.getElementById("grid");
const selectCat=document.getElementById("filterCat");
const searchInput=document.getElementById("searchInput");
const countLabel=document.getElementById("countNum");
const btnList=document.getElementById("btnList");
const btnCards=document.getElementById("btnCards");
const btnDark=document.getElementById("btnDark");
const btnSync=document.getElementById("btnSync");

/* ===== Globale Zust√§nde ===== */
let vocabData=[];
let selectedRows=new Set();

/* ===== Hilfsfunktionen zum LocalStorage ===== */
function saveLocal(){
  localStorage.setItem("vokabeln",JSON.stringify(vocabData));
}
function loadLocal(){
  const d=localStorage.getItem("vokabeln");
  return d?JSON.parse(d):[];
}

/* ===== Kategorie-Selects f√ºllen ===== */
function populateCategoryFilter(){
  selectCat.innerHTML='<option value="Alle">Alle (bunt gemischt)</option><option value="confuse">‚ö†Ô∏è Verwechslungsgefahr</option>';
  for(const k in CATS){
    const [name,bg,fg]=CATS[k];
    const opt=document.createElement("option");
    opt.value=k;opt.textContent=name;
    opt.style.background=bg;opt.style.color=fg;
    selectCat.appendChild(opt);
  }
}
function populateEditCategorySelect(){
  mCat.innerHTML="";
  for(const k in CATS){
    const [name,bg,fg]=CATS[k];
    const opt=document.createElement("option");
    opt.value=k;opt.textContent=name;
    opt.style.background=bg;opt.style.color=fg;
    mCat.appendChild(opt);
  }
}

/* ===== Neuerstellungsvorlage ===== */
function newVocab(){
  return ["","",Object.keys(CATS)[0],"","",new Date().toISOString(),0];
}

/* ===== Eventlistener f√ºr Modal ===== */
mCat.onchange=()=>{
  const [_,bg,fg]=CATS[mCat.value];
  mCat.style.background=bg;mCat.style.color=fg;
};

/* ===== Startdaten vorbereiten ===== */
populateCategoryFilter();
populateEditCategorySelect();
vocabData=loadLocal();

/* ===== N√§chster Teil bringt Rendering und Logik ===== */
/* ==================== Rendering ==================== */
let viewMode="list";           // ‚Äûlist‚Äú oder ‚Äûcards‚Äú
let currentPage=1;
const PAGE_SIZE=15;
let adjustMode=false;

/* === Haupt-Renderfunktion === */
function render(){
  const q=searchInput.value.toLowerCase().trim();
  const cat=selectCat.value;
  let filtered=vocabData.filter(v=>{
    const matchCat=cat==="Alle"||(cat==="confuse"&&v[6])||(v[2]===cat);
    const matchQ=!q||v[0].toLowerCase().includes(q)||v[1].toLowerCase().includes(q);
    return matchCat&&matchQ;
  });
  const pages=Math.ceil(filtered.length/PAGE_SIZE)||1;
  if(currentPage>pages)currentPage=pages;
  const start=(currentPage-1)*PAGE_SIZE;
  const data=filtered.slice(start,start+PAGE_SIZE);
  countLabel.textContent=`${filtered.length}`;

  if(viewMode==="list"){
    renderTable(data);
    grid.style.display="none";
    document.getElementById("tableContainer").style.display="block";
  }else{
    renderCards(data);
    grid.style.display="grid";
    document.getElementById("tableContainer").style.display="none";
  }
  renderPagination(pages);
}

/* ==================== Tabellenansicht ==================== */
function renderTable(data){
  tblBody.innerHTML=data.map((v,i)=>{
    const confuse=v[6]?'<span class="red-flag" title="Verwechslungsgefahr">‚ö†Ô∏è</span>':'';
    const [label,bg,fg]=CATS[v[2]];
    return `
      <tr data-idx="${i}" class="row">
        <td style="width:32px;text-align:center;"><span style="opacity:.6;">‚úèÔ∏è</span></td>
        <td>${v[0]} ${confuse}</td>
        <td>${v[1]}</td>
        <td><span class="category-chip" style="background:${bg};color:${fg}">${label}</span></td>
      </tr>`;
  }).join("");

  Array.from(tblBody.querySelectorAll(".row")).forEach(row=>{
    row.onclick=()=>openEdit(parseInt(row.dataset.idx));
  });
}

/* ==================== Kachelansicht ==================== */
function renderCards(data){
  grid.innerHTML=data.map((v,i)=>{
    const confuse=v[6]?'‚ö†Ô∏è':'';
    const [label,bg,fg]=CATS[v[2]];
    const sel=selectedRows.has(i)?"selected":"";
    return `
      <div class="card ${sel}" data-idx="${i}">
        <div class="card-title">${v[0]} <span class="confuse">${confuse}</span></div>
        <div class="card-sub">DE: ${v[1]}</div>
        <div class="card-cat" style="background:${bg};color:${fg}">${label}</div>
      </div>`;
  }).join("");

  Array.from(grid.querySelectorAll(".card")).forEach(card=>{
    card.onclick=()=>{
      const idx=parseInt(card.dataset.idx);
      if(!adjustMode){openEdit(idx);return;}
      if(selectedRows.has(idx))selectedRows.delete(idx);else selectedRows.add(idx);
      card.classList.toggle("selected");
    };
  });
}

/* ==================== Pagination ==================== */
function renderPagination(total){
  const cont=document.getElementById("pagination");
  if(total<=1){cont.innerHTML="";return;}
  cont.innerHTML=`
    <button class="outline" id="prevPg" ${currentPage===1?"disabled":""}>‚¨ÖÔ∏è</button>
    <span style="margin:0 10px;">Seite ${currentPage} / ${total}</span>
    <button class="outline" id="nextPg" ${currentPage===total?"disabled":""}>‚û°Ô∏è</button>
  `;
  document.getElementById("prevPg").onclick=()=>{if(currentPage>1){currentPage--;render();}};
  document.getElementById("nextPg").onclick=()=>{currentPage++;render();};
}

/* ==================== Modal-Logik ==================== */
function openEdit(i){
  const v=vocabData[i];
  modal.style.display="flex";
  mEn.value=v[0];
  mDe.value=v[1];
  mCat.value=v[2];
  mGroup.value=v[3];
  mHint.value=v[4];
  mDate.value=new Date(v[5]).toISOString().slice(0,10);
  mConfuse.checked=v[6];
  btnSave.onclick=()=>saveEdit(i);
}
function closeModal(){modal.style.display="none";}
btnCancel.onclick=closeModal;
modal.onclick=e=>{if(e.target===modal)closeModal();};

function saveEdit(i){
  const updated=[
    mEn.value.trim(),
    mDe.value.trim(),
    mCat.value,
    mGroup.value.trim(),
    mHint.value.trim(),
    vocabData[i][5],
    mConfuse.checked?1:0
  ];
  vocabData[i]=updated;
  saveLocal();
  closeModal();
  render();
}

/* ==================== Neu / L√∂schen ==================== */
function addNew(){
  vocabData.push(newVocab());
  saveLocal();
  render();
}
function deleteSelected(){
  if(!selectedRows.size)return alert("Keine Auswahl");
  if(!confirm(`${selectedRows.size} Eintr√§ge l√∂schen?`))return;
  vocabData=vocabData.filter((_,i)=>!selectedRows.has(i));
  selectedRows.clear();
  saveLocal();
  render();
}

/* ==================== Filter / Suche ==================== */
selectCat.onchange=()=>{currentPage=1;render();};
searchInput.oninput=()=>{currentPage=1;render();};
document.getElementById("btnReset").onclick=()=>{
  searchInput.value="";
  selectCat.value="Alle";
  currentPage=1;
  render();
};

/* ==================== Ansichtsschalter ==================== */
btnList.onclick=()=>{viewMode="list";btnList.classList.add("active");btnCards.classList.remove("active");render();}
btnCards.onclick=()=>{viewMode="cards";btnCards.classList.add("active");btnList.classList.remove("active");render();}
/* ==================== Mobile-Bar und Aktionen ==================== */
const mobileBar=document.createElement("div");
mobileBar.className="mobile-bar";
mobileBar.innerHTML=`
  <button id="mbTrainer" class="outline">üéØ Trainer</button>
  <button id="mbAdjust" class="primary">‚úèÔ∏è Anpassen</button>
  <button id="mbSync" class="outline">üîÑ Sync</button>
`;
document.body.appendChild(mobileBar);

const mbTrainer=document.getElementById("mbTrainer");
const mbAdjust=document.getElementById("mbAdjust");
const mbSync=document.getElementById("mbSync");

/* === mobile Bar Funktionalit√§t === */
mbTrainer.onclick=()=>location.href="index.html";
mbAdjust.onclick=()=>{
  adjustMode=!adjustMode;
  selectedRows.clear();
  Array.from(document.querySelectorAll(".card")).forEach(c=>c.classList.remove("selected"));
  if(adjustMode){
    mbAdjust.textContent="‚úÖ Fertig";
    mbSync.textContent="üóëÔ∏è L√∂schen";
    mbSync.classList.add("danger");
    mbSync.onclick=deleteSelected;
  }else{
    mbAdjust.textContent="‚úèÔ∏è Anpassen";
    mbSync.textContent="üîÑ Sync";
    mbSync.classList.remove("danger");
    mbSync.onclick=syncNow;
  }
};
mbSync.onclick=syncNow;

/* ==================== Dark-Mode-Toggle ==================== */
function applyDarkMode(on){
  document.body.classList.toggle("dark",on);
  localStorage.setItem("darkMode",on?"1":"0");
}
function toggleDarkMode(){
  const on=!document.body.classList.contains("dark");
  applyDarkMode(on);
  btnDark.textContent=on?"‚òÄÔ∏è Light Mode":"üåô Dark Mode";
}
/* restore last mode */
applyDarkMode(localStorage.getItem("darkMode")==="1");
btnDark.textContent=document.body.classList.contains("dark")?"‚òÄÔ∏è Light Mode":"üåô Dark Mode";
btnDark.onclick=toggleDarkMode;

/* sanftes Fading bei Mode-Wechsel */
const cssFade=document.createElement("style");
cssFade.textContent=`body{transition:background-color .4s ease,color .4s ease;}`;
document.head.appendChild(cssFade);

/* ==================== GitHub-/Sync-Simulation ==================== */
async function syncNow(){
  try{
    btnSync.textContent="‚è≥ Sync l√§uft‚Ä¶";
    await new Promise(r=>setTimeout(r,1200)); // simulierte Netzwartezeit
    btnSync.textContent="‚úÖ Synchronisiert";
    setTimeout(()=>btnSync.textContent="üì§ Sync",1500);
  }catch(e){
    console.warn("Sync-Fehler",e);
    btnSync.textContent="‚ùå Fehler";
  }
}

/* ==================== Startlogik ==================== */
render();

/* --- Public API optional f√ºr externe Nutzung --- */
window.vocabApp={
  add:addNew,
  delete:deleteSelected,
  render,
  syncNow,
  toggleDarkMode
};

})(); // Ende IIFE
</script>
</body>
</html>
