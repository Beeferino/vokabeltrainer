<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>üìò Vokabel√ºbersicht ‚Äì Beeferino</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
:root{
  --ink:#0f172a;
  --muted:#6b7280;
  --bg:#f7f9fb;
  --card:#ffffff;
  --blue:#2563eb;
  --ok:#16a34a;
  --bad:#ef4444;
  --border:#e5ebf3;
  --shadow:0 8px 26px rgba(0,0,0,.08)
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Inter,system-ui,sans-serif;
  background:linear-gradient(145deg,#eef4ff,#dbeafe);
  color:var(--ink);
  transition:background .3s,color .3s;
}
a{color:#1e3a8a;text-decoration:none}
.app{max-width:1100px;margin:20px auto;padding:16px}
h1{text-align:center;font-weight:800;color:#1e3a8a;margin:0}
.hr{width:160px;height:4px;background:#2563eb;border-radius:4px;margin:10px auto 20px}
.toolbar{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  justify-content:center;
  margin:10px 0;
}
.toolbar select,.toolbar input{
  padding:8px 12px;
  border:1px solid #cfd6e4;
  border-radius:10px;
}
.toolbar button{
  border:none;
  border-radius:10px;
  padding:8px 14px;
  font-weight:700;
  cursor:pointer;
}
button.primary{background:var(--blue);color:#fff;}
button.outline{background:#fff;border:1px solid #cfd6e4;color:#111;}
button.danger{background:var(--bad);color:#fff;}
button.active{background:var(--blue);color:#fff;}
.subtitle{text-align:center;font-weight:600;color:#1e3a8a;margin-bottom:12px;}
</style>
</head>
<body>
<div class="app">
  <h1>üìò Vokabel√ºbersicht</h1>
  <div class="hr"></div>

  <!-- Toolbar -->
  <div class="toolbar">
    <select id="filterCategory">
      <option value="Alle">Alle (bunt gemischt)</option>
      <option value="confuse">‚ö†Ô∏è Verwechslungsgefahr</option>
    </select>
    <input type="text" id="searchInput" placeholder="Suchen ‚Ä¶">
    <button id="btnReset" class="outline">Reset</button>
    <button id="btnNew" class="primary">+ Neue</button>
    <button id="btnDelete" class="danger" disabled>L√∂schen</button>
    <button id="btnSync" class="outline" style="max-width:160px;">üìÑ Sync</button>
  </div>

  <!-- Ansichtsschalter -->
  <div class="toolbar">
    <button id="btnList" class="outline active">üìã Liste</button>
    <button id="btnCards" class="outline">üß© Kacheln</button>
    <button id="btnDark" class="outline">üåô Dark Mode</button>
  </div>

  <!-- Z√§hler -->
  <div class="subtitle"><b id="vocabCount">‚Äì</b> Vokabeln gefunden</div>

  <!-- Tabelle -->
  <div id="tableContainer">
    <table id="vocabTable" style="width:100%;border-collapse:collapse;">
      <thead>
        <tr>
          <th style="width:30px;"><input type="checkbox" id="selectAll"></th>
          <th>Englisch</th>
          <th>Deutsch</th>
          <th>Kategorie</th>
          <th>Aktion</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>
  </div>

  <!-- Kachelansicht -->
  <div id="gridContainer" class="grid" style="display:none;"></div>

  <!-- Mobile Footer-Buttons -->
  <div id="mobileBar" class="mobile-bar">
    <button id="btnTrainer" class="outline">Trainer</button>
    <button id="btnAdjust" class="primary">Anpassen</button>
    <button id="btnSyncMobile" class="outline">Sync</button>
  </div>
</div>
<!-- Bearbeiten-Modal -->
<div class="modal" id="editModal" style="display:none;">
  <div class="panel">
    <h3 id="modalTitle" style="margin-top:0">Vokabel bearbeiten</h3>
    <div class="form-grid">
      <label>Englisch
        <input id="mEn" type="text" placeholder="Englisches Wort">
      </label>
      <label>Deutsch
        <input id="mDe" type="text" placeholder="Deutsche √úbersetzung">
      </label>
      <label>Kategorie
        <select id="mCat"></select>
      </label>
      <label>Gruppe / Variante
        <input id="mGroup" type="text" placeholder="z. B. Werkzeug">
      </label>
      <label>Hinweis
        <textarea id="mHint" rows="2" placeholder="optional"></textarea>
      </label>
      <div class="toggle">
        <span>Verwechslungsgefahr</span>
        <label class="switch">
          <input type="checkbox" id="mConfuse">
          <span class="slider"></span>
        </label>
      </div>
      <label>Erstellt
        <input id="mDate" type="text" readonly style="background:#f3f4f6;">
      </label>
    </div>
    <div class="modal-actions">
      <button class="outline" id="btnCancel">Abbrechen</button>
      <button class="primary" id="btnSave">Speichern</button>
    </div>
  </div>
</div>

<style>
/* Modal + Form-Layout + Toggle */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.4);display:none;align-items:center;justify-content:center;z-index:50}
.panel{background:#fff;border-radius:14px;padding:20px;width:92%;max-width:520px;box-shadow:var(--shadow)}
.form-grid{display:grid;gap:10px}
.form-grid input,.form-grid select,.form-grid textarea{
  width:100%;padding:10px;border:1px solid #cfd6e4;border-radius:10px;font-family:inherit
}
.modal-actions{display:flex;justify-content:flex-end;gap:10px;margin-top:18px}
.switch{position:relative;display:inline-block;width:50px;height:26px}
.switch input{opacity:0;width:0;height:0}
.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;transition:.3s;border-radius:34px}
.slider:before{position:absolute;content:"";height:20px;width:20px;left:3px;bottom:3px;background-color:white;transition:.3s;border-radius:50%}
input:checked + .slider{background-color:#ef4444}
input:checked + .slider:before{transform:translateX(24px)}
</style>

<script>
(function(){

/* ==================== Kategorien-Setup ==================== */
const CATS={
  Gelb:["Grundwerkzeuge Metallverarbeitung","#F4D03F","#000"],
  Pink:["Werkzeugkasten Mechaniker","#E91E63","#fff"],
  Blau:["Blech- / Kunststoffarbeiten","#1976D2","#fff"],
  Gruen:["Drehen / Fr√§sen","#1E8449","#fff"],
  HellesPink:["Hydraulik / Pneumatik","#F54927","#fff"],
  Orange:["Elektrotechnik","#E67E22","#fff"],
  Dunkelgruen:["Flugger√§temechanik allgemein","#117A65","#fff"]
};

/* ==================== DOM-Referenzen ==================== */
const tblBody=document.getElementById("tableBody");
const grid=document.getElementById("gridContainer");
const countLabel=document.getElementById("vocabCount");
const selectCat=document.getElementById("filterCategory");
const searchInput=document.getElementById("searchInput");
const btnList=document.getElementById("btnList");
const btnCards=document.getElementById("btnCards");
const btnNew=document.getElementById("btnNew");
const btnDelete=document.getElementById("btnDelete");
const btnSync=document.getElementById("btnSync");
const selectAll=document.getElementById("selectAll");

/* Modal-Felder */
const modal=document.getElementById("editModal");
const mEn=document.getElementById("mEn");
const mDe=document.getElementById("mDe");
const mCat=document.getElementById("mCat");
const mGroup=document.getElementById("mGroup");
const mHint=document.getElementById("mHint");
const mConfuse=document.getElementById("mConfuse");
const mDate=document.getElementById("mDate");
const btnSave=document.getElementById("btnSave");
const btnCancel=document.getElementById("btnCancel");

/* ==================== Datenmodell ==================== */
let vocabData=[];
const normalize=v=>[
  v[0]||"",v[1]||"",v[2]||"Gelb",
  v[3]||"",v[4]||"",
  v[5]||new Date().toISOString(),
  v[6]?1:0
];
function loadLocal(){
  return JSON.parse(localStorage.getItem("vokabeln")||"[]").map(normalize);
}
function saveLocal(){
  localStorage.setItem("vokabeln",JSON.stringify(vocabData));
}

/* ==================== Initiale Kategorien-Dropdowns ==================== */
function populateEditCategorySelect(){
  mCat.innerHTML="";
  for(const k in CATS){
    const [label,bg,fg]=CATS[k];
    const o=document.createElement("option");
    o.value=k;o.textContent=label;o.style.background=bg;o.style.color=fg;
    mCat.appendChild(o);
  }
}
function populateCategoryFilter(){
  while(selectCat.options.length>2)selectCat.remove(2);
  for(const k in CATS){
    const [label,bg,fg]=CATS[k];
    const o=document.createElement("option");
    o.value=k;o.textContent=label;o.style.background=bg;o.style.color=fg;
    selectCat.appendChild(o);
  }
}
/* ==================== Rendering ==================== */
let viewMode="list";
let currentPage=1;
const PAGE_SIZE=15;
let selectedRows=new Set();
let adjustMode=false;

function render(){
  const q=searchInput.value.toLowerCase().trim();
  const cat=selectCat.value;
  let filtered=vocabData.filter(v=>{
    const matchCat=cat==="Alle"||(cat==="confuse"&&v[6])||(v[2]===cat);
    const matchQ=!q||v[0].toLowerCase().includes(q)||v[1].toLowerCase().includes(q);
    return matchCat&&matchQ;
  });
  const pages=Math.ceil(filtered.length/PAGE_SIZE)||1;
  if(currentPage>pages)currentPage=pages;
  const start=(currentPage-1)*PAGE_SIZE;
  const data=filtered.slice(start,start+PAGE_SIZE);
  countLabel.textContent=`${filtered.length}`;

  if(viewMode==="list"){
    renderTable(data);
    grid.style.display="none";
    document.getElementById("tableContainer").style.display="block";
  }else{
    renderCards(data);
    grid.style.display="grid";
    document.getElementById("tableContainer").style.display="none";
  }

  renderPagination(pages);
}

/* ==================== Tabelle ==================== */
function renderTable(data){
  tblBody.innerHTML=data.map((v,i)=>{
    const confuseIcon=v[6]?'<span style="color:#ef4444;margin-left:4px;" title="Verwechslungsgefahr">‚ö†Ô∏è</span>':'';
    const [label,bg,fg]=CATS[v[2]];
    return `
      <tr>
        <td><input type="checkbox" data-index="${i}"></td>
        <td>${v[0]} ${confuseIcon}</td>
        <td>${v[1]}</td>
        <td><span style="background:${bg};color:${fg};padding:4px 10px;border-radius:999px;font-weight:600;">${label}</span></td>
        <td><button class="outline small" data-edit="${i}">Bearbeiten</button></td>
      </tr>`;
  }).join("");
  Array.from(tblBody.querySelectorAll("button[data-edit]")).forEach(btn=>{
    btn.onclick=()=>openEdit(parseInt(btn.dataset.edit));
  });
  Array.from(tblBody.querySelectorAll("input[type=checkbox][data-index]")).forEach(ch=>{
    ch.onchange=()=>{
      const i=parseInt(ch.dataset.index);
      if(ch.checked)selectedRows.add(i);else selectedRows.delete(i);
      btnDelete.disabled=selectedRows.size===0;
    };
  });
}

/* ==================== Kachelansicht ==================== */
function renderCards(data){
  grid.innerHTML=data.map((v,i)=>{
    const confuse=v[6]?'‚ö†Ô∏è':'';
    const [label,bg,fg]=CATS[v[2]];
    const sel=selectedRows.has(i)?"selected":"";
    return `
      <div class="card ${sel}" data-idx="${i}">
        <div class="card-header">
          <div class="card-title">${v[0]} <span class="confuse">${confuse}</span></div>
          <div class="card-sub">DE: ${v[1]}</div>
        </div>
        <div class="card-cat" style="background:${bg};color:${fg}">${label}</div>
      </div>`;
  }).join("");

  Array.from(grid.querySelectorAll(".card")).forEach(card=>{
    card.onclick=()=>{
      if(!adjustMode){const idx=parseInt(card.dataset.idx);openEdit(idx);return;}
      const idx=parseInt(card.dataset.idx);
      if(selectedRows.has(idx))selectedRows.delete(idx);else selectedRows.add(idx);
      card.classList.toggle("selected");
    };
  });
}

/* ==================== Pagination ==================== */
function renderPagination(total){
  let cont=document.getElementById("pagination");
  if(!cont){
    cont=document.createElement("div");
    cont.id="pagination";
    cont.style.textAlign="center";
    cont.style.margin="12px";
    document.querySelector(".app").appendChild(cont);
  }
  if(total<=1){cont.innerHTML="";return;}
  cont.innerHTML=`
    <button class="outline" id="prevPg" ${currentPage===1?"disabled":""}>‚¨ÖÔ∏è</button>
    <span style="margin:0 10px;">Seite ${currentPage} / ${total}</span>
    <button class="outline" id="nextPg" ${currentPage===total?"disabled":""}>‚û°Ô∏è</button>
  `;
  document.getElementById("prevPg").onclick=()=>{currentPage--;if(currentPage<1)currentPage=1;render();};
  document.getElementById("nextPg").onclick=()=>{currentPage++;render();};
}

/* ==================== Modal-Logik ==================== */
function openEdit(i){
  const v=vocabData[i];
  modal.style.display="flex";
  mEn.value=v[0];
  mDe.value=v[1];
  mCat.value=v[2];
  mGroup.value=v[3];
  mHint.value=v[4];
  mConfuse.checked=v[6];
  mDate.value=new Date(v[5]).toISOString().slice(0,10);
  btnSave.onclick=()=>saveEdit(i);
}
function closeModal(){modal.style.display="none";}
btnCancel.onclick=closeModal;
modal.onclick=e=>{if(e.target===modal)closeModal();};

function saveEdit(i){
  const updated=[
    mEn.value.trim(),
    mDe.value.trim(),
    mCat.value,
    mGroup.value.trim(),
    mHint.value.trim(),
    vocabData[i][5],
    mConfuse.checked?1:0
  ];
  vocabData[i]=updated;
  saveLocal();
  closeModal();
  render();
}

/* ==================== Buttons ==================== */
btnNew.onclick=()=>{
  vocabData.push(["","",Object.keys(CATS)[0],"","",new Date().toISOString(),0]);
  saveLocal();
  render();
};
btnDelete.onclick=()=>{
  if(!selectedRows.size)return;
  if(!confirm(`${selectedRows.size} l√∂schen?`))return;
  vocabData=vocabData.filter((_,i)=>!selectedRows.has(i));
  selectedRows.clear();
  saveLocal();
  render();
};

/* ==================== Filter / Suche ==================== */
selectCat.onchange=()=>{currentPage=1;render();};
searchInput.oninput=()=>{currentPage=1;render();};
document.getElementById("btnReset").onclick=()=>{
  searchInput.value="";selectCat.value="Alle";currentPage=1;render();
};

/* ==================== Ansichtsschalter ==================== */
btnList.onclick=()=>{viewMode="list";btnList.classList.add("active");btnCards.classList.remove("active");render();}
btnCards.onclick=()=>{viewMode="cards";btnCards.classList.add("active");btnList.classList.remove("active");render();}

/* ==================== Mobile Buttons ==================== */
const bar=document.getElementById("mobileBar");
const btnTrainer=document.getElementById("btnTrainer");
const btnAdjust=document.getElementById("btnAdjust");
const btnSyncMobile=document.getElementById("btnSyncMobile");

btnTrainer.onclick=()=>location.href="index.html";
btnSyncMobile.onclick=()=>alert("Sync gestartet ...");
btnAdjust.onclick=()=>{
  adjustMode=!adjustMode;
  if(adjustMode){
    bar.innerHTML=`
      <button id="btnDeleteMob" class="danger">L√∂schen</button>
      <button id="btnDoneMob" class="primary">Fertig</button>
      <button id="btnNewMob" class="outline">Neue Vokabel</button>`;
    document.getElementById("btnDeleteMob").onclick=btnDelete.onclick;
    document.getElementById("btnNewMob").onclick=btnNew.onclick;
    document.getElementById("btnDoneMob").onclick=()=>{
      adjustMode=false;
      bar.innerHTML='<button id="btnTrainer" class="outline">Trainer</button><button id="btnAdjust" class="primary">Anpassen</button><button id="btnSyncMobile" class="outline">Sync</button>';
      document.getElementById("btnTrainer").onclick=btnTrainer.onclick;
      document.getElementById("btnAdjust").onclick=btnAdjust.onclick;
      document.getElementById("btnSyncMobile").onclick=btnSyncMobile.onclick;
      selectedRows.clear();render();
    };
  }else{
    bar.innerHTML='<button id="btnTrainer" class="outline">Trainer</button><button id="btnAdjust" class="primary">Anpassen</button><button id="btnSyncMobile" class="outline">Sync</button>';
    document.getElementById("btnTrainer").onclick=btnTrainer.onclick;
    document.getElementById("btnAdjust").onclick=btnAdjust.onclick;
    document.getElementById("btnSyncMobile").onclick=btnSyncMobile.onclick;
  }
  render();
}

/* ==================== Start ==================== */
populateEditCategorySelect();
populateCategoryFilter();
vocabData=loadLocal();
render();
/* ==================== Dark Mode ==================== */
const btnDark=document.getElementById("btnDark");
let darkMode=false;
btnDark.onclick=()=>{
  darkMode=!darkMode;
  document.body.classList.toggle("dark",darkMode);
  btnDark.textContent=darkMode?"‚òÄÔ∏è Light Mode":"üåô Dark Mode";
};

/* ==================== Service ==================== */
})(); // Ende Hauptfunktion
</script>

<style>
/* ====== Kartenlayout ====== */
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(320px,1fr));
  gap:16px;
  margin-top:16px;
}
.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:14px;
  padding:14px;
  box-shadow:var(--shadow);
  transition:.25s;
  cursor:pointer;
}
.card:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(0,0,0,.1);}
.card.selected{outline:3px solid var(--blue);}
.card-title{font-weight:800;font-size:1.05rem;margin-bottom:6px;}
.card-sub{color:var(--muted);margin-bottom:10px;}
.card-cat{
  display:inline-block;
  padding:4px 10px;
  border-radius:999px;
  font-weight:700;
  font-size:.9rem;
}
.confuse{color:#ef4444;font-weight:700;margin-left:6px;}

/* ====== Mobile Footer Buttons ====== */
.mobile-bar{
  position:sticky;
  bottom:0;
  background:rgba(255,255,255,.9);
  display:flex;
  justify-content:space-between;
  gap:8px;
  padding:10px;
  border-top:1px solid var(--border);
  z-index:30;
}
.mobile-bar button{
  flex:1;
  padding:12px;
  border-radius:10px;
  font-weight:700;
}

/* ====== Dark Mode Styling ====== */
body.dark{
  --bg:#0f172a;
  --ink:#f1f5f9;
  --card:#1e293b;
  --border:#334155;
  --muted:#94a3b8;
  background:linear-gradient(145deg,#1e293b,#0f172a);
  color:var(--ink);
  transition:background .4s,color .4s;
}
body.dark .panel{background:#1e293b;color:#f1f5f9;border:1px solid #334155;}
body.dark .toolbar button.outline{background:#1e293b;color:#f1f5f9;border-color:#475569;}
body.dark .toolbar select,body.dark .toolbar input{background:#1e293b;color:#f1f5f9;border-color:#475569;}
body.dark .card{background:#1e293b;border-color:#334155;}
body.dark .mobile-bar{background:rgba(30,41,59,.9);}
body.dark .modal{background:rgba(0,0,0,.6);}
body.dark table{color:var(--ink);}
body.dark tr:hover{background:#334155;}

/* ====== Fade Animation ====== */
body,body.dark{
  transition:background-color .4s ease,color .4s ease;
}

/* ====== Tabellenstil ====== */
table{width:100%;border-collapse:collapse}
th,td{padding:10px;border-bottom:1px solid var(--border);text-align:left}
tr:hover{background:#f8fbff}
button.small{font-size:.9rem;padding:5px 10px}

/* ====== Responsiveness ====== */
@media(max-width:900px){
  .toolbar,#tableContainer{display:none}
  .grid{grid-template-columns:1fr 1fr;}
  .mobile-bar{display:flex}
}
@media(min-width:901px){
  .mobile-bar{display:none}
}
</style>

</body>
</html>
